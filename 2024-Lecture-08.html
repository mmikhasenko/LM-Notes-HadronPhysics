<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mikhail Mikhasenko">

<title>lecture-08 – Hadron Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 8.8em;
  margin: 0 8.8em 8.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c7317bc481e33d2be5001a05e340a262.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#unitarity-analyticity-and-the-schwarz-reflection-principle" id="toc-unitarity-analyticity-and-the-schwarz-reflection-principle" class="nav-link active" data-scroll-target="#unitarity-analyticity-and-the-schwarz-reflection-principle"><span class="header-section-number">8.1</span> Unitarity, Analyticity, and the Schwarz Reflection Principle</a></li>
  <li><a href="#cauchys-theorem-and-numerical-integration-of-discontinuous-functions" id="toc-cauchys-theorem-and-numerical-integration-of-discontinuous-functions" class="nav-link" data-scroll-target="#cauchys-theorem-and-numerical-integration-of-discontinuous-functions"><span class="header-section-number">8.2</span> Cauchy’s Theorem and Numerical Integration of Discontinuous Functions</a></li>
  <li><a href="#the-scattering-amplitude-analyticity-unitarity-and-threshold-behavior" id="toc-the-scattering-amplitude-analyticity-unitarity-and-threshold-behavior" class="nav-link" data-scroll-target="#the-scattering-amplitude-analyticity-unitarity-and-threshold-behavior"><span class="header-section-number">8.3</span> The Scattering Amplitude: Analyticity, Unitarity, and Threshold Behavior</a></li>
  <li><a href="#analyticity-threshold-singularities-and-unitarity-in-scattering-amplitudes" id="toc-analyticity-threshold-singularities-and-unitarity-in-scattering-amplitudes" class="nav-link" data-scroll-target="#analyticity-threshold-singularities-and-unitarity-in-scattering-amplitudes"><span class="header-section-number">8.4</span> Analyticity, Threshold Singularities, and Unitarity in Scattering Amplitudes</a></li>
  <li><a href="#square-root-behavior-and-schwarz-reflection-principle-in-threshold-energy-analysis" id="toc-square-root-behavior-and-schwarz-reflection-principle-in-threshold-energy-analysis" class="nav-link" data-scroll-target="#square-root-behavior-and-schwarz-reflection-principle-in-threshold-energy-analysis"><span class="header-section-number">8.5</span> Square Root Behavior and Schwarz Reflection Principle in Threshold Energy Analysis</a></li>
  <li><a href="#analytic-structure-and-branch-cuts-in-square-root-functions" id="toc-analytic-structure-and-branch-cuts-in-square-root-functions" class="nav-link" data-scroll-target="#analytic-structure-and-branch-cuts-in-square-root-functions"><span class="header-section-number">8.6</span> Analytic Structure and Branch Cuts in Square Root Functions</a></li>
  <li><a href="#resonances-as-poles-in-the-scattering-amplitude-a-house-analogy-for-complex-plane-dynamics" id="toc-resonances-as-poles-in-the-scattering-amplitude-a-house-analogy-for-complex-plane-dynamics" class="nav-link" data-scroll-target="#resonances-as-poles-in-the-scattering-amplitude-a-house-analogy-for-complex-plane-dynamics"><span class="header-section-number">8.7</span> Resonances as Poles in the Scattering Amplitude: A House Analogy for Complex Plane Dynamics</a></li>
  <li><a href="#thresholds-branch-points-and-poles-in-amplitude-analysis" id="toc-thresholds-branch-points-and-poles-in-amplitude-analysis" class="nav-link" data-scroll-target="#thresholds-branch-points-and-poles-in-amplitude-analysis"><span class="header-section-number">8.8</span> Thresholds, Branch Points, and Poles in Amplitude Analysis</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mikhail Mikhasenko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="unitarity-analyticity-and-the-schwarz-reflection-principle" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="unitarity-analyticity-and-the-schwarz-reflection-principle"><span class="header-section-number">8.1</span> Unitarity, Analyticity, and the Schwarz Reflection Principle</h3>
<p>In today’s lecture, I would like to discuss <strong>unitarity</strong> and <strong>complex numbers</strong>, and move towards discussing <strong>complex functions</strong>. We had too little time in the previous lecture to cover these aspects, but they are <strong>important to understand</strong> and connect to what you already know from mathematics.</p>
<hr>
<p>I will introduce two mathematical concepts:</p>
<ul>
<li><strong>Analytic functions</strong></li>
<li><strong>Holomorphic functions</strong> (which are interchangeable terms)</li>
</ul>
<p>A function is called <strong>analytic</strong> if there is a Taylor series equal to the function in the vicinity of each point. If there are coefficients such that the series gives exact values of the function, then the function is analytic at the point <span class="math inline">X</span>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The Taylor series expansion for an analytic function at point <span class="math inline">x_0</span> is: <span class="math display">
f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(x_0)}{n!} (x - x_0)^n
</span></p>
</div>
</div>
</div>
<p>A function is analytic at <span class="math inline">X_0</span> if the series exists for <span class="math inline">(X - X_0)^N</span>, with coefficients depending on <span class="math inline">X_0</span>: <span class="math display">
f(X) = \sum_{n=0}^{\infty} \frac{f^{(n)}(X_0)}{n!} (X - X_0)^n.
</span> If the <strong>complex derivatives</strong> exist—meaning the limit exists when approaching the point from any direction—the function is called <strong>holomorphic</strong>, which is the same as analytic. <em>Holomorphic is just a fancy word for analytic—mathematicians like cool terms.</em></p>
<hr>
<ul>
<li><strong>All polynomials</strong> are fully analytic.</li>
<li><strong>Rational functions</strong> (polynomials divided by polynomials) are analytic except at the zeros of the denominator.</li>
<li>A function is analytic in a <strong>domain</strong> if every point in that domain is a point of analyticity.</li>
<li>The <strong>square root function</strong> <span class="math inline">\sqrt{X}</span> is analytic everywhere except at zero, where it has no derivative or valid Taylor series—this is called a <strong>branch point</strong>.</li>
</ul>
<hr>
<p><strong>Real analytic functions</strong> are another interesting class. For example, <span class="math inline">\sqrt{X}</span> is real analytic. They satisfy the <strong>Schwarz reflection principle</strong>: when extended to the complex plane, the function evaluated at the conjugate point equals the conjugate of the function: <span class="math display">
f(\overline{z}) = \overline{f(z)}.
</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Demonstration using <span class="math inline">1 + i = \sqrt{2} e^{i\pi/4}</span>:</p>
<ul>
<li><span class="math inline">\sqrt{1 + i} = 2^{1/4} e^{i\pi/8}</span></li>
<li><span class="math inline">\sqrt{1 - i} = 2^{1/4} e^{-i\pi/8}</span> This confirms the reflection principle since <span class="math inline">\sqrt{\overline{z}} = \overline{\sqrt{z}}</span>.</li>
</ul>
</div>
</div>
</div>
<hr>
<p>For <strong>analytic functions</strong> of a single argument, it’s useful to visualize the domain as the complex plane:</p>
<ul>
<li><strong>Real part</strong> on the x-axis</li>
<li><strong>Imaginary part</strong> on the y-axis</li>
</ul>
<p>The Schwarz reflection principle implies <strong>symmetry</strong> between the upper and lower planes—values in the lower plane can be derived from the upper plane via conjugation.</p>
<p>For instance:</p>
<ul>
<li><span class="math inline">1 + i</span> has magnitude <span class="math inline">\sqrt{2}</span> and angle <span class="math inline">\pi/4</span></li>
<li>Its square root is <span class="math inline">2^{1/4} e^{i\pi/8}</span></li>
<li>Similarly, <span class="math inline">1 - i</span> gives the conjugate result, illustrating the reflection principle.</li>
</ul>
</section>
<section id="cauchys-theorem-and-numerical-integration-of-discontinuous-functions" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="cauchys-theorem-and-numerical-integration-of-discontinuous-functions"><span class="header-section-number">8.2</span> Cauchy’s Theorem and Numerical Integration of Discontinuous Functions</h3>
<p>I would like to cover <strong>Cauchy’s theorem</strong>. It states that the integral over a closed contour in the complex plane of a function is equal to all <strong>non-analytic contributions</strong> inside this contour. If it’s a pole, it’s given by residues. If it’s a branch point, the correct way is to contour around it, and so on—the left side captures all non-analytic behavior.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Cauchy’s Integral Theorem (general form)</strong>: <span class="math display">
\oint_\gamma f(z) \, dz = 2\pi i \sum \text{Res}(f, a_k)
</span> where <span class="math inline">\gamma</span> is a closed contour and <span class="math inline">a_k</span> are the poles (or other singularities) inside <span class="math inline">\gamma</span>.</p>
</div>
</div>
</div>
<p>What I realized recently is that this is actually a <strong>numerically well-defined procedure</strong> to integrate a discontinuous function. For example, we can compute the integral of <span class="math inline">\sqrt{z}</span> over a circle of radius 1, and the integral converges despite the function being discontinuous at the branch point.</p>
<p>On the circle, the function is parameterized as <span class="math inline">z = e^{i\phi}</span>. Above the branch cut, it’s <span class="math inline">+i</span>, and below, it’s <span class="math inline">-i</span>. If I plot the function in the integration domain, the integral becomes: <span class="math display">
\int_0^{2\pi} i e^{i\phi} \sqrt{e^{i\phi}} \, d\phi.
</span> The key point is that within the integration domain <span class="math inline">0</span> to <span class="math inline">2\pi</span>, the function jumps at <span class="math inline">\phi = 0</span> due to the branch cut. Yet, the integral remains well-defined because it’s equivalent to integrating around the branch point.</p>
<p>Let me emphasize this more clearly. The integral is: <span class="math display">
\int_0^{2\pi} e^{i\phi} \cdot i \cdot \sqrt{e^{i\phi}} \, d\phi.
</span> This simplifies to: <span class="math display">
\int_0^{2\pi} e^{3i\phi/2} \, d\phi.
</span> However, since the function is discontinuous, I cannot naively evaluate it at the endpoints.</p>
<hr>
<p>A better approach is to shift the integration range to <span class="math inline">-\pi</span> to <span class="math inline">\pi</span>, where the function is continuous. Mathematically, this becomes: <span class="math display">
\int_{-\pi}^{\pi} e^{3i\phi/2} \, d\phi.
</span> Evaluating this properly accounts for the branch cut.</p>
<p>The deeper insight here is that this integral equals the integral of the <strong>discontinuity across the branch cut</strong>. If I shrink the contour, it’s equivalent to integrating <span class="math inline">\sqrt{z}</span> along the real axis from <span class="math inline">0</span> to <span class="math inline">-1</span>. You’ll find the same result—this is the power of <strong>Cauchy’s theorem</strong>.</p>
<p>It tells you that you can deform the contour freely, as long as you avoid <strong>non-analytic regions</strong>. You can compute the integral along the circle or shrink it to a real-axis integration. For this example, I encourage you to verify that both methods give the same answer.</p>
<hr>
<p>The final step is to evaluate the real-axis integral: <span class="math display">
\int_{-1}^0 \sqrt{x} \, dx.
</span> This is straightforward, and the result aligns with the contour integration. The key takeaway is that even with discontinuities, <strong>Cauchy’s theorem</strong> provides a rigorous way to compute such integrals.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Equivalence of Methods</strong>: The integral along the branch cut (<span class="math inline">\int_{-1}^0 \sqrt{x} \, dx</span>) matches the contour integral result, demonstrating the flexibility of contour deformation in complex analysis.</p>
</div>
</div>
</div>
</section>
<section id="the-scattering-amplitude-analyticity-unitarity-and-threshold-behavior" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="the-scattering-amplitude-analyticity-unitarity-and-threshold-behavior"><span class="header-section-number">8.3</span> The Scattering Amplitude: Analyticity, Unitarity, and Threshold Behavior</h3>
<p>The <strong>scattering amplitude</strong> is the <em>real magic function</em>. Let’s come back to our two sketches in the amplitude, for which we derived the <strong>optical theorem</strong> and discussed the <strong>analytic structure</strong> of this function. The claim is that the amplitude is a <em>real magic function</em>, or part of it.</p>
<hr>
<ol type="1">
<li><p><strong>Assumptions</strong>: The amplitude is not accessed directly in the experiment, so we cannot validate its properties exactly. What we measure is the amplitude squared. Access to the amplitude itself is only available through our observables.</p></li>
<li><p><strong>Constraints from Scattering Theory</strong>: However, scattering theory and probability conservation imply that certain properties of the amplitude constrain the imaginary part and tell us where the imaginary part is present.</p></li>
</ol>
<hr>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Analyticity as a Postulate</strong>: The fact that it’s analytic is a postulate. This is something we have to assume—though it’s stronger than an assumption. We don’t assume its analytic properties; this is the building principle of our series.</p>
</div>
</div>
</div>
<hr>
<ul>
<li><p><strong>Unitarity</strong>: All series we have seen so far have unitarity built in. Therefore, not only unitarity but also <strong>causality</strong>, which is related to analyticity.</p></li>
<li><p><strong>Causality and Analyticity</strong>: The amplitude being an analytic function is a principle postulated in our theory. It is related to the <strong>causality</strong> of the theory—that the past does not influence events outside the causality cone.</p></li>
</ul>
<p>This connection is not derived here, but you can find it in several books linking causality to analyticity. We take it as a postulate.</p>
<hr>
<ul>
<li><p><strong>Analyticity</strong>: The amplitude is analytic, and unitarity further tells us that it is <strong>real analytic below the threshold</strong>.</p></li>
<li><p><strong>Imaginary Part and Thresholds</strong>: The imaginary part is connected to the appearance of particles in intermediate states. This only occurs <strong>above threshold</strong>, because the interaction introduces an imaginary part there. Below threshold, the amplitude has no imaginary part; it is purely real.</p></li>
</ul>
<hr>
<ol type="1">
<li><p><strong>Optical Theorem</strong>: <span class="math display">
\text{Im}\, f(0) = \frac{k}{4\pi} \sigma_{\text{tot}}
</span></p></li>
<li><p><strong>Unitarity Condition</strong>: <span class="math display">
\text{Im}\, f(\theta) = \frac{k}{4\pi} \int f^*(\theta') f(\theta) \, d\Omega'
</span></p></li>
<li><p><strong>Threshold Behavior</strong>: <span class="math display">
f(E) = \begin{cases}
\text{real} &amp; \text{if } E &lt; E_{\text{threshold}} \\
\text{complex} &amp; \text{if } E \geq E_{\text{threshold}}
\end{cases}
</span></p></li>
</ol>
</section>
<section id="analyticity-threshold-singularities-and-unitarity-in-scattering-amplitudes" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="analyticity-threshold-singularities-and-unitarity-in-scattering-amplitudes"><span class="header-section-number">8.4</span> Analyticity, Threshold Singularities, and Unitarity in Scattering Amplitudes</h3>
<p>So here I have a diagram on the <span class="math inline">x</span>-axis. Again, it’s a complex plane of the energy. The variable <span class="math inline">S</span> is <span class="math inline">E^2</span>, where <span class="math inline">E</span> is the center-of-mass energy, and the amplitude as a function of <span class="math inline">S</span> is an analytic function.</p>
<p>What we get to deal with is only the values of this amplitude above the threshold. However, the past tenets of our theory tell you that using analyticity, we can extend the domain of the definition into the full complex plane.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Idea</strong>: The amplitude <span class="math inline">A(s)</span> can be analytically continued into the complex plane, allowing us to evaluate it at complex energies, not just real ones above threshold.</p>
</div>
</div>
</div>
<p>I hope you wrap your mind around the idea that now we can extend this analytic domain and think of our amplitude as a complex function. So instead of energy of the interactions of, say, 5 GeV, you can put a complex number there and then probe the function away from the real axis.</p>
<p>Now, this function has a certain range of singularities. From the fact that the imaginary part is not present below threshold and then suddenly appears above threshold tells you that a certain singular disk pops up. And these singularities are the branch points.</p>
<p>At every threshold, there are nice derivations of the threshold singularities for different numbers of particles. In Gribov’s book, I leave it out. However, something easy to see is the two-body threshold. And I want to show you that it introduces square root singularities. It simply follows from the fact that the imaginary part has a square root.</p>
<hr>
<p>So let me show you that the imaginary part of the amplitude from unitarity that we derived last time is related to the amplitude squared itself. The unitarity condition is:</p>
<p><span class="math display">
\text{Im}\, A(s) = \frac{1}{2} |A(s)|^2 \cdot \Phi_2(s)
</span></p>
<p>where <span class="math inline">\Phi_2(s)</span> is the two-body phase space factor.</p>
<p>The prefactor here is the phase space—simply two-body phase space. The one-half comes from <span class="math inline">(A - A^*)</span>. So, the imaginary part here—I replace it—and <span class="math inline">\frac{1}{2}</span> over here.</p>
<p>The two-body phase space has the form:</p>
<p><span class="math display">
\Phi_2(s) = \frac{2p}{\sqrt{s}}
</span></p>
<p>where <span class="math inline">p</span> is the breakup momentum. This is something that actually makes a singularity, something that vanishes at the threshold.</p>
<hr>
<p>The breakup momentum is the momentum particles have. Clearly, if you are at the threshold, you have a minimal energy of the system. It’s simply two masses of the particles. They don’t have free energy; they don’t have momentum. And that’s something that vanishes, and it vanishes.</p>
<p>Mathematically, you see that if you compute this two-body breakup momentum—I think you’ve done it in earlier exercises—you find that it’s equal to the Källén function:</p>
<p><span class="math display">
p = \frac{\sqrt{\lambda(s, m_1^2, m_2^2)}}{2\sqrt{s}}
</span></p>
<p>where <span class="math inline">\lambda</span> is the Källén function:</p>
<p><span class="math display">
\lambda(x, y, z) = x^2 + y^2 + z^2 - 2xy - 2yz - 2zx
</span></p>
<p>or equivalently:</p>
<p><span class="math display">
\lambda(x, y, z) = (x - (y + z)^2)(x - (y - z)^2)
</span></p>
<p>Remember this: the first term gives you a singularity at the threshold, and the second one gives you a singularity at the pseudo-threshold.</p>
</section>
<section id="square-root-behavior-and-schwarz-reflection-principle-in-threshold-energy-analysis" class="level3" data-number="8.5">
<h3 data-number="8.5" class="anchored" data-anchor-id="square-root-behavior-and-schwarz-reflection-principle-in-threshold-energy-analysis"><span class="header-section-number">8.5</span> Square Root Behavior and Schwarz Reflection Principle in Threshold Energy Analysis</h3>
<p>Interior relations, as we wrote it, as we derived, are valid <strong>only above the threshold</strong>. The imaginary part is non-zero and present only once you go above the threshold.</p>
<p>This imaginary part behaves like a <strong>square root function</strong>:</p>
<p><span class="math display">
\text{Im}\, f(E) \propto \sqrt{E - E_{\text{th}}},
</span></p>
<p>where <span class="math inline">E</span> is the energy and <span class="math inline">E_{\text{th}}</span> is the threshold energy. This indicates that the function itself has a <strong>square root branch point</strong>.</p>
<hr>
<p>Above the threshold, the function exhibits this square root behavior. It would be useful to connect this to the <strong>Schwarz reflection principle</strong>.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Since our function was real and analytic on a segment of the real axis, the Schwarz reflection principle applies. It relates the amplitude in the upper half-plane to the amplitude in the lower half-plane:</p>
<p><span class="math display">
f(E + i\epsilon) = \overline{f(E - i\epsilon)},
</span></p>
<p>for real <span class="math inline">E</span> and small <span class="math inline">\epsilon &gt; 0</span>, where <span class="math inline">\overline{f}</span> denotes the complex conjugate.</p>
</div>
</div>
</div>
<hr>
<p>This means the imaginary part flips sign when you cross the real axis:</p>
<p><span class="math display">
\text{Im}\, f(E + i\epsilon) = -\text{Im}\, f(E - i\epsilon).
</span></p>
<p>The relation holds for <span class="math inline">\epsilon</span> small enough.</p>
<hr>
<ul>
<li>The <strong>square root behavior</strong> of <span class="math inline">\text{Im}\, f(E)</span> is tied to the threshold energy <span class="math inline">E_{\text{th}}</span>.</li>
<li>The <strong>Schwarz reflection principle</strong> ensures symmetry between the upper and lower half-planes.</li>
<li>The sign flip in the imaginary part reflects the <strong>discontinuity</strong> across the real axis.</li>
</ul>
</section>
<section id="analytic-structure-and-branch-cuts-in-square-root-functions" class="level3" data-number="8.6">
<h3 data-number="8.6" class="anchored" data-anchor-id="analytic-structure-and-branch-cuts-in-square-root-functions"><span class="header-section-number">8.6</span> Analytic Structure and Branch Cuts in Square Root Functions</h3>
<p>Have you heard a song with the word <strong>“infinitesimal”</strong>? I think it’s by one of the rock bands. I was really impressed. This is now in pop, in rock. People like the word. Maybe next time I’ll bring you something. I was impressed recently. Who is singing <strong>“Infinite”</strong>? You know, <em>Mother Mother</em>. That’s about <em>Mother Mother</em>. So listen to the song <strong>“Infinitesimal.”</strong> I like the song actually, but it just means very, very small—<strong>infinitesimal</strong>.</p>
<hr>
<p>I’m going to use this <span class="math inline">i\varepsilon</span>, and you’ve seen it before. This is just the little number that indicates you are like a very, very small amount above the real axis or below the real axis. It happens due to the <strong>phase space</strong>. We realized that if the function had no phase space configuration summations on the right, you could relate the imaginary part to the real part itself, and there would not be branch points. But it’s unavoidable. You have to sum over phase configurations, and that gives you the <strong>square root branch point</strong>. It also tells you that the amplitude has a branch point starting at the threshold and going in the positive direction.</p>
<hr>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <span class="math inline">i\varepsilon</span> prescription is a common technique in complex analysis and quantum field theory to handle poles and branch cuts by shifting the contour infinitesimally away from the real axis.</p>
</div>
</div>
</div>
<hr>
<p>I wanted to quickly give an example of such a function—an example of a <strong>real analytic function</strong>, discarding this cut to the right. An example of a real analytic function like our scattering amplitude, but something very simple with a square root function that has a cut to the right. So <span class="math inline">\sqrt{x}</span> doesn’t work—its cut is on the left. Let’s cut to the left. How do I see where it has the cut? Simply because <span class="math inline">\text{Amplitude}(1 + \varepsilon) = \text{Amplitude}(1 - \varepsilon)</span>, there is no cut. Then, <span class="math inline">\sqrt{-1 - \varepsilon} = -i</span>, and <span class="math inline">\sqrt{-1 + \varepsilon} = i</span>. On this side, the function evaluated from above and below have different values. That tells me in which direction I put my cut.</p>
<hr>
<p>This is a <strong>branch point</strong>, and this is a <strong>non-analytic point</strong>. But for every branch point, there is a cut attached, and it splits my manifold. Analyticity into the functions—into the surfaces—differentiates. Everywhere else except this point, the functions are analytic. But you have to work to see this analyticity. Essentially, you have to <strong>analytically continue</strong> functions. If you see the pattern, you want to make this function analytic. It’s always possible, but you have to work a little by extending the domain of analyticity.</p>
<hr>
<p>Coming back to the example, you’ll understand it better once I finish this. If I take <span class="math inline">-\sqrt{x}</span>, what was the analytic structure of <span class="math inline">-\sqrt{x}</span>? According to the same logic, I can evaluate the function somewhere in the complex plane and find that it’s now analytic here, fully analytic, and it has a cut to the right. Now, let’s evaluate this function at <span class="math inline">-1</span>. What does it equal? So I evaluate my function here, and it gives me <span class="math inline">\sqrt{1}</span>. This is an example of a <strong>real analytic function</strong>. Or let’s take the simplest amplitude: the amplitude <span class="math inline">\mathcal{A}(s) = \sqrt{-(s - m_1^2 - m_2^2)}</span>, which has similar properties. It has similar properties.</p>
<hr>
<p>Quickly, while I’m cleaning the board—what is the analytic structure of this? This is in the <span class="math inline">x</span>-plane. The first one I put as <span class="math inline">-9</span> to make it more interesting. This first one has the cut on the right, and the second one has a cut—it’s very similar but shifted by one. Essentially, it has this structure: one cut, then a second cut. When you have this situation, there is no jump here. You can jump twice, and the cuts overlap, so there’s no jump in the function. It’s analytic right here. The correct answer is just the cuts connecting two points.</p>
<hr>
<p>This one is tricky. The first time I saw it in a mathematical context, I was really shocked because the branch points are the same. There are two points, <span class="math inline">x</span> and <span class="math inline">x</span>, where the function is non-analytic. But the locations of the cuts are determined by where the expression under the square root has an argument of <span class="math inline">\pi</span> or <span class="math inline">-\pi</span>. For a regular square root function, the cut appears where the argument is either <span class="math inline">\pi</span> or <span class="math inline">-\pi</span>. To understand where your Mathematica, C, or Python library would draw a cut, you need to know where the expression under the square root has an argument touching <span class="math inline">\pi</span> or <span class="math inline">-\pi</span>.</p>
<hr>
<p>And then, apparently, this is indeed between the points but also along this line. This is the first cut going to infinity, and this is the second cut going to infinity. It’s crazy. And this is actually different from this. If you just split the product into two square roots, then the argument—then you remove these two. It’s not to confuse you, but to warn you that you must be careful how you write the expression, exactly how you split the square root, because that makes the function different. On the real axis, I think they will be the same, but on the complex plane, the functions are different.</p>
<hr>
<p>To prove to you that this is not equal to that, we can simply evaluate the function at <span class="math inline">-1</span>. I think that’s an easy exercise. The way I see that they are different is because I know the analytic structure of this: one cut and then a second cut. There are just two branch points connected by the cut. To go from this to that, I can take this cut, rotate it over here, take this one, rotate it over there, and cancel the two cuts—make them cancel each other. That tells me the function in the original configuration has a different value at <span class="math inline">-1</span>. If I evaluate it, I should see this immediately.</p>
<hr>
<p>If I evaluate the top one, I get <span class="math inline">\sqrt{(-2)(-1)}</span>. If I evaluate the second one, I get <span class="math inline">\sqrt{2} \cdot i</span>. Then the product of them gives me <span class="math inline">-\sqrt{2}</span>.</p>
<hr>
<div class="callout callout-style-simple callout-warning">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Be cautious when splitting square roots in complex analysis: <span class="math inline">\sqrt{ab} \neq \sqrt{a} \cdot \sqrt{b}</span> in general due to branch cut ambiguities. The example shows <span class="math inline">\sqrt{(-2)(-1)} \neq \sqrt{-2} \cdot \sqrt{-1}</span> because of differing branch cut configurations.</p>
</div>
</div>
</div>
</section>
<section id="resonances-as-poles-in-the-scattering-amplitude-a-house-analogy-for-complex-plane-dynamics" class="level3" data-number="8.7">
<h3 data-number="8.7" class="anchored" data-anchor-id="resonances-as-poles-in-the-scattering-amplitude-a-house-analogy-for-complex-plane-dynamics"><span class="header-section-number">8.7</span> Resonances as Poles in the Scattering Amplitude: A House Analogy for Complex Plane Dynamics</h3>
<p>Its resonances are <strong>poles of the scattering amplitude</strong>. When you hear that, you’re probably going to hear this many times in the future.</p>
<p>I would like you to think of the <strong>intensity flow</strong>. The function in the complex plane is the complex structure of a house. In this house, there are just a few routers. You desperately want your Internet—the farther you are from the router, the weaker the signal you get. If you sit at a point and have really good Internet, you’re probably sitting near the router.</p>
<p>Similarly, this is our couch in the house where people usually sit and experience different strengths of the Internet. The routers are the <strong>resonances</strong>. Here I have combined two modes on the Y-axis. On the complex S-plane, the real <span class="math inline">s</span> is on the axis, and this indicates minus imaginary <span class="math inline">s</span>. This is the same as I would have for the complex frame.</p>
<p>I draw a square representing the strength of your Internet when you sit on this couch. In the middle, you have the closest distance to the router, the <strong>resonance pole</strong>, and therefore your strength is the highest. If you sit far away, your Internet weakens.</p>
<hr>
<p>Now let’s make the model more complicated. We have several layers, and this is given by the <strong>cuts</strong>. Here is my map of the room. As usual, I am the source where people sit on the real axis. But in this case, the model is more complex. There is a room with different electronics, different floors, so I can go to another room.</p>
<p>I experience all the routers in another room. If there is a router sitting here in another room, I want to see its influence from my car. This is floor one, and the next is floor two. Sheet one is floor one, and sheet two is floor two. Here’s the gate—think of it as stairs from one floor to another.</p>
<p>If I have my router here, I have really good strength here and here as well. But if I go around the corner, I start losing the signal. The distance becomes large, and the way to get Internet is around the wall. This is the gate to another floor, and I can only enter on that side.</p>
<hr>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Insight</strong>: The resonances are the resonances. I see them on each floor. If they are above the threshold, it’s too complicated.</p>
</div>
</div>
</div>
<p>When you hear about the complex plane and the poles, think of the <strong>intensity floor</strong> somewhere in the complex domain. This is all complex domain. There are gates to other floors—don’t think of them as changing the level, but as connecting one to another. On this surface with different levels, you place the resonances. These resonances influence your intensity, which you see on the detectors.</p>
<hr>
<p>What is the difference between a bigger room and multiple floors? No difference. The rooms are infinitely big. But since at every point I can be on different floors connected smoothly, I have to draw several maps, several sheets. In shopping malls, you also have multiple floors with shops indicated because it’s hard to show everything on a single one.</p>
<p>For simplicity, I would use the term <strong>“branch cut,”</strong> which tells us the cut should be to the right. But I would never do it practically like that. The branch cut tells me that, but nothing happens if I place the cut to the left.</p>
<hr>
<p>I will demonstrate with the <strong>square root function</strong>. It has a branch cut, and I’m carrying my function value here. There is nothing happening if I draw the cut in different directions. This function is the same function as before.</p>
<p>At <span class="math inline">s = -1</span>, you have <span class="math inline">i</span>. At <span class="math inline">s = -1 + \epsilon</span>, you have <span class="math inline">i</span>. This function and that function are exactly the same in this dimension. The difference is that I took my branch cut and rotated it to the right, opening the space underneath.</p>
<hr>
<p>I just made a renovation and changed how the rooms are located in the house. But it changes nothing in the strength of the interaction because there are no walls. Everything is continuous. The cut is just a way to separate different floors. There is no wall preventing the signal strength.</p>
<p>For practical reasons, it’s convenient to open up the closest room to us. Therefore, it’s more natural to place the cut in a convenient location. The cut goes to the right, but I turn it to the left. Now my function is not real, but I expose a bigger range of the complex plane to analyze.</p>
<hr>
<p>If I sit here on the real axis, this point is influenced by all singularities in the complex plane that are nearby. If I have a pole here, I don’t have to care about the rooms anymore. I immediately see the effect in the strength of my interaction if my router is nearby. This is the most convenient way to think of the complex plane and the scattering amplitude.</p>
<hr>
<p>I measure my amplitude above threshold at <span class="math inline">s = (M_1 + M_2)^2</span>. What I measure is influenced by structures near threshold. If there is a resonance in the data, it means there is a pole below that makes this resonance. A resonance is always a pole—this is how we define particles.</p>
<p>Particles are always poles in the amplitude. We have conventions for defining the width and mass of the resonance, and they come from the pole location. A single-pole amplitude has the form:</p>
<p><span class="math display">
A(s) \sim \frac{1}{s - s_{\text{pole}}}
</span></p>
<p>where <span class="math inline">s_{\text{pole}}</span> is the complex pole location. The denominator vanishes at <span class="math inline">s = s_{\text{pole}}</span>, which is a complex number. The real and imaginary parts are called the mass and width of the pole.</p>
<p>We define the mass as <span class="math inline">\Re\sqrt{s_{\text{pole}}}</span> and the width as <span class="math inline">-2\Im\sqrt{s_{\text{pole}}}</span>. These are related to the observed mass and width. If you see a signal, it has a peak location and a full width at half maximum. For narrow resonances, <span class="math inline">\Gamma \approx \text{FWHM}</span> and <span class="math inline">m \approx \text{peak location}</span>. For broad resonances, this is not the case.</p>
<hr>
<p>What is the analytic structure of this function? It is simply a pole. There are no branch points, nothing else. A slightly more complex example is the <strong>K-matrix</strong>, which incorporates poles and correct analytic structure, including square-root branch points from phase space:</p>
<p><span class="math display">
A(s) = \frac{K(s)}{1 - i\rho(s)K(s)}
</span></p>
<p>It works for multiple loops.</p>
<hr>
<p>The last comment is on data analysis. The goal is to characterize resonances by their pole location. We use parameterizations like the K-matrix or P-vector. A simple Breit-Wigner is a limit case of the K-matrix. The amplitude has a complicated expression but is analytic.</p>
<p>You fit parameters to the data, then explore the analytic expression. You know it has a branch point, but the direction of the cut is your choice. What’s important is that everything you see—peaks, spikes—has an origin in the complex plane. If there’s a peak, there’s likely a pole there.</p>
</section>
<section id="thresholds-branch-points-and-poles-in-amplitude-analysis" class="level3" data-number="8.8">
<h3 data-number="8.8" class="anchored" data-anchor-id="thresholds-branch-points-and-poles-in-amplitude-analysis"><span class="header-section-number">8.8</span> Thresholds, Branch Points, and Poles in Amplitude Analysis</h3>
<p>Another important phenomenon you see sometimes in the data is the <strong>cusp</strong>. This is amplitude squared, this is <span class="math inline">S</span>. And then you see a cusp. That type of singularity is also known as a <strong>branch point</strong>.</p>
<hr>
<p>The first threshold introduces a branch point—every threshold introduces a singularity. For two particles, it’s a branch point. We already discussed this branch point. But if there are more than two particles, combinations like <span class="math inline">\pi\pi</span>, <span class="math inline">KK</span>, or <span class="math inline">K\bar{K}</span> would give a branch point at <strong>1 GeV</strong>.</p>
<hr>
<p>Then my amplitude might have a spike like this. It’s an indication that in the complex plane all is fine, but there is a branch point. For every branch point, I have to attach a tail. This is the location of my cut—it’s up to me how to draw it—but it introduces more surfaces. This is a direction.</p>
<hr>
<p>The last thing to realize is that this is a triangle. We know that at threshold the function has <strong>square root singularities</strong>. But thresholds are only opening new surfaces for you. Thresholds are only determining the map of your complex plane.</p>
<hr>
<p>The real singularities, or the <strong>strong singularities</strong> that make intensity peak, are <strong>poles</strong>. So this situation, where your amplitude squared has this threshold behavior but then rises very quickly and falls, indicates that there are some poles nearby. If the poles were underneath—if the poles were like that—that kind of function would peak at the place.</p>
<hr>
<p>But in that case, what likely happens is that there is a <strong>bound state</strong>, a pole here. If there is a pole on the real axis, it would not show up as a nice resonance-like peaking structure.</p>
<hr>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Threshold condition for two-particle production</strong>: <span class="math display">
S = (M_1 + M_2)^2
</span> where <span class="math inline">S</span> is the Mandelstam variable (center-of-mass energy squared), and <span class="math inline">M_1, M_2</span> are the masses of the two particles.</p>
</div>
</div>
</div>
<hr>
<p>Think again about the map of routers and the internet. If you have a router here and you sit on the couch, the signal strength will be highest here and then lower, lower, lower there. That’s simply how to understand <strong>threshold enhancements</strong>.</p>
<p>Threshold enhancements are often indications of poles below threshold—these are bound states. There is another phenomenon: poles at the same locations but underneath another sheet, called a <strong>virtual state</strong>. These are not that different from each other.</p>
<hr>
<p>The bound state can live forever—it’s a real state that can travel, a particle that does not decay. The virtual state does not travel and does not decay. This is simply an enhancement.</p>
<p>This is a distinction—one of the objectives and discussion points in the field. When you observe a new structure, what kind is it?</p>
<ul>
<li>Is it related to a threshold?</li>
<li>Is it a pole sitting below a certain threshold?</li>
<li>Or is it a resonance in the complex plane unrelated to a threshold?</li>
</ul>
<hr>
<p>Relation to a threshold indicates a <strong>molecular nature</strong>. Remember, every threshold has two masses summed—it implies a continuum. There is one particle and a second particle interacting. This is our threshold.</p>
<p>If there is a pole related to a threshold, likely part of the wave function for this state is of this type—a <strong>molecular type</strong>. That’s why identifying all thresholds and the complex structure, and where the resonance pole sits, is so important.</p>
<hr>
<p>Finishing the lecture—quick questions:</p>
<ul>
<li>“<span class="math inline">S - (M_1 + M_2)^2</span>.”</li>
<li>“The other so-called threshold—what is what?”</li>
<li>“With the so-called threshold <span class="math inline">S - (M_1 - M_2)^2</span>?”</li>
<li>“Yes. What’s with this one?”</li>
<li>“It’s a ‘zeta threshold.’ It appears artificially in our expressions because of the breakup momentum. But if you look at the amplitude, it’s not supposed to have a singularity there.</li>
</ul>
<hr>
<p>You cannot literally take this expression and continue at the threshold. This is a sort of <strong>false threshold</strong>. We don’t see this. It tells you this is an indication that you should not take this expression literally and build it into your model.</p>
<p>Instead of using phase space—<span class="math inline">\frac{1}{8\pi} \frac{2p}{\sqrt{S}}</span>—it’s actually the imaginary part of this bubble. The imaginary part.</p>
<hr>
<p>You see this simply from unitarity: once you cut this diagram, the imaginary part would be equal to the matrix element here and there, which are both 1, and the two-body phase space because you cut two lines. Here is the two-body phase space.</p>
<p>The ‘surface threshold’ here is present because you use only the imaginary part in your amplitude. If you were to take the full bubble diagram, you don’t have a surface threshold there.”</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mikhail Mikhasenko">

<title>lecture-05-test-mac – Hadron Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6729c19c459079745e2be02720e68a89.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#angular-distributions-partial-wave-analysis-and-kinematics-in-two-particle-scattering" id="toc-angular-distributions-partial-wave-analysis-and-kinematics-in-two-particle-scattering" class="nav-link active" data-scroll-target="#angular-distributions-partial-wave-analysis-and-kinematics-in-two-particle-scattering"><span class="header-section-number">0.1</span> Angular Distributions, Partial Wave Analysis, and Kinematics in Two-Particle Scattering</a></li>
  <li><a href="#charm-decay-kinematics-and-the-dalitz-plot-in-lambda_c-baryon-decay" id="toc-charm-decay-kinematics-and-the-dalitz-plot-in-lambda_c-baryon-decay" class="nav-link" data-scroll-target="#charm-decay-kinematics-and-the-dalitz-plot-in-lambda_c-baryon-decay"><span class="header-section-number">0.2</span> Charm Decay Kinematics and the Dalitz Plot in <span class="math inline">\Lambda_c</span> Baryon Decay</a></li>
  <li><a href="#maximizing-and-minimizing-mass-in-three-body-decay-kinematics" id="toc-maximizing-and-minimizing-mass-in-three-body-decay-kinematics" class="nav-link" data-scroll-target="#maximizing-and-minimizing-mass-in-three-body-decay-kinematics"><span class="header-section-number">0.3</span> Maximizing and Minimizing Mass in Three-Body Decay Kinematics</a></li>
  <li><a href="#rotations-spin-projections-and-wigner-d-functions-in-quantum-systems" id="toc-rotations-spin-projections-and-wigner-d-functions-in-quantum-systems" class="nav-link" data-scroll-target="#rotations-spin-projections-and-wigner-d-functions-in-quantum-systems"><span class="header-section-number">0.4</span> Rotations, Spin Projections, and Wigner <span class="math inline">D</span>-Functions in Quantum Systems</a></li>
  <li><a href="#addressing-an-issue-and-scheduling-follow-up" id="toc-addressing-an-issue-and-scheduling-follow-up" class="nav-link" data-scroll-target="#addressing-an-issue-and-scheduling-follow-up"><span class="header-section-number">0.5</span> Addressing an Issue and Scheduling Follow-Up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mikhail Mikhasenko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="angular-distributions-partial-wave-analysis-and-kinematics-in-two-particle-scattering" class="level3" data-number="0.1">
<h3 data-number="0.1" class="anchored" data-anchor-id="angular-distributions-partial-wave-analysis-and-kinematics-in-two-particle-scattering"><span class="header-section-number">0.1</span> Angular Distributions, Partial Wave Analysis, and Kinematics in Two-Particle Scattering</h3>
<p>Today we are at lecture number five. We’ll discuss <strong>angular distributions</strong> and <strong>partial wave analysis</strong>. But before going there, I would like to start with a recap.</p>
<hr>
<p>In the last lecture, we discussed:</p>
<ul>
<li>The <strong>phase space</strong> for particle reactions</li>
<li>Different experiments and their <strong>kinematics</strong></li>
<li>Experiments worldwide studying <strong>hadrons</strong>, their production mechanisms, and peculiarities</li>
</ul>
<p>We start with a recap on <strong>kinematics</strong>.</p>
<hr>
<p><strong>First question:</strong> <em>How many variables describe a two-particle scattering process?</em></p>
<p>We have two cases:</p>
<ol type="1">
<li><strong>Scalar particles</strong> (<span class="math inline">0^-</span>):</li>
</ol>
<ul>
<li>Initial state: two <span class="math inline">0^-</span> scalars</li>
<li>Final state: two <span class="math inline">0^-</span> scalars</li>
</ul>
<ol start="2" type="1">
<li><strong>Particles with spin</strong>:</li>
</ol>
<ul>
<li>Example: <span class="math inline">1^+</span> scattering with <span class="math inline">3^-</span></li>
<li>Final state: <span class="math inline">3^-</span> and <span class="math inline">1^+</span></li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The scattering process is represented by a “blob” (unitarity diagram, not a Feynman diagram). The blob encapsulates the interaction (strong, electromagnetic, etc.), while arrows indicate incoming/outgoing particles.</p>
</div>
</div>
</div>
<hr>
<p><strong>Task:</strong> Calculate the number of variables needed to fully describe the process.</p>
<ol type="1">
<li><strong>Without spin</strong>:</li>
</ol>
<ul>
<li>Initial count: 8 (from conservation laws)</li>
<li>Subtract 6 (3 rotations + 3 boosts due to frame invariance)</li>
<li><strong>Result:</strong> 2 variables</li>
</ul>
<ol start="2" type="1">
<li><strong>With spin</strong>:</li>
</ol>
<ul>
<li>Same as above: <strong>2 variables</strong> (spin orientation doesn’t add independent kinematic variables for 2→2 scattering).</li>
</ul>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <strong>scattering amplitude</strong> for spinless particles is a <strong>scalar function</strong> of <span class="math inline">s</span> and <span class="math inline">t</span>. For particles with spin, it becomes a higher-rank object (e.g., 21-dimensional for <span class="math inline">3^- \times 1^+</span>), but still depends on <strong>the same two variables</strong>.</p>
</div>
</div>
</div>
<hr>
<p>The process is fully described by <strong>two independent Lorentz-invariant variables</strong>. Common choices:</p>
<ol type="1">
<li><strong>Mandelstam variables</strong>:</li>
</ol>
<ul>
<li><span class="math inline">s = (P_1 + P_2)^2</span> (center-of-mass energy squared)</li>
<li><span class="math inline">t = (P_1 - P_3)^2</span> (momentum transfer squared)</li>
<li><span class="math inline">u = (P_1 - P_4)^2</span> (with <span class="math inline">s + t + u = \sum m_i^2</span>)</li>
</ul>
<ol start="2" type="1">
<li><strong>Center-of-mass frame variables</strong>:</li>
</ol>
<ul>
<li><span class="math inline">\sqrt{s}</span> (center-of-mass energy)</li>
<li><span class="math inline">\theta</span> (scattering angle between <span class="math inline">\vec{p}_1</span> and <span class="math inline">\vec{p}_3</span>)</li>
</ul>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Any two <strong>independent</strong> variables work (e.g., lab-frame energies <span class="math inline">E_1</span>, <span class="math inline">E_3</span>), but Mandelstam variables avoid frame-specific distortions.</p>
</div>
</div>
</div>
<hr>
<p>For <strong>three-body decay</strong> (<span class="math inline">1 \to 2 + 3 + 4</span>), the kinematics are similarly described by <strong>two variables</strong>:</p>
<ul>
<li><span class="math inline">s_{34} = (P_3 + P_4)^2</span></li>
<li><span class="math inline">t_{13} = (P_1 - P_3)^2</span></li>
</ul>
<p><strong>Key properties</strong>:</p>
<ul>
<li>The <strong>phase space</strong> is <strong>flat</strong> in Mandelstam variables (<span class="math inline">dN/ds_{34}\,dt_{13} = \text{constant}</span>).</li>
<li>This makes the <strong>Dalitz plot</strong> a powerful tool for studying dynamics.</li>
</ul>
<hr>
<p>The <strong>three-body phase space</strong> is given by: <span class="math display">
d\Phi_3 = \frac{1}{(2\pi)^5} \frac{d^3p_2}{2E_2} \frac{d^3p_3}{2E_3} \frac{d^3p_4}{2E_4} \delta^4(P_1 - P_2 - P_3 - P_4)
</span></p>
<p>Using the <strong>recursive formula</strong>: <span class="math display">
d\Phi_3 = d\Phi_2(M;m_3,m_4) \times d\Phi_2(M\to m_1; m_2, M_{34}) \times \frac{1}{8\pi^2} ds_{34}
</span></p>
<hr>
<p>The <strong>Dalitz plot</strong> (plotting <span class="math inline">s_{34}</span> vs.&nbsp;<span class="math inline">t_{13}</span>) directly reveals dynamics:</p>
<ul>
<li>No kinematic distortions in Mandelstam variables.</li>
<li>Deviations from flatness indicate <strong>resonances</strong> or <strong>interactions</strong>.</li>
</ul>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>This marks the shift from general particle physics to <strong>hadron-specific</strong> topics, focusing on <strong>spectroscopy</strong> and <strong>three-body decays</strong>.</p>
</div>
</div>
</div>
<hr>
<ul>
<li><strong>Exercise</strong>: Study the <strong>Dalitz plot</strong> for three-body decays.</li>
<li><strong>Next</strong>: Dive deeper into <strong>angular distributions</strong> and <strong>partial wave analysis</strong>.</li>
</ul>
<p>Questions? Let’s discuss before moving on!</p>
</section>
<section id="charm-decay-kinematics-and-the-dalitz-plot-in-lambda_c-baryon-decay" class="level3" data-number="0.2">
<h3 data-number="0.2" class="anchored" data-anchor-id="charm-decay-kinematics-and-the-dalitz-plot-in-lambda_c-baryon-decay"><span class="header-section-number">0.2</span> Charm Decay Kinematics and the Dalitz Plot in <span class="math inline">\Lambda_c</span> Baryon Decay</h3>
<p>You can see the example of the triple decay that I have here: the <span class="math inline">\Lambda_c</span> baryon going to the proton, kaon, and pion. We measure <span class="math inline">\Lambda_c</span> produced in proton-proton collisions or any other collisions. In the <strong>BES experiment</strong> and <strong>Belle experiment</strong>, they observe <span class="math inline">\Lambda_c</span>. This is one of those particles that lives a long time and is produced abundantly.</p>
<hr>
<p>Particles with charm ground states are produced abundantly, and they live sufficiently long to fly from the primary vertex. We reconstruct them, which is why we have a good sample and a good understanding of their decay kinematics—and not only kinematics but dynamics as well, the content of this blob.</p>
<hr>
<p>In that decay, you see there is a charm quark in the initial state and no charm quark in the final state, indicating this happens via <strong>weak interaction</strong>. The charm quark disappears between the initial and final states. It decays, transitioning into the strange quark that ends up in the kaon. The <span class="math inline">c \to s</span> transition happens within one generation, so this is <strong>not suppressed</strong>—it’s an allowed process.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The weak decay process involves: <span class="math display">\Lambda_c^+ \to p^+ + K^- + \pi^+</span> <span class="math display">c \to s + W^+ \quad \text{(with } W^+ \to u\bar{d}\text{)}</span></p>
</div>
</div>
</div>
<hr>
<p>This is the <strong>golden channel</strong> for detection because, in the final state, you have three charged particles. There are no neutrals.</p>
<ul>
<li>The <strong>proton</strong> is a nice charged particle—it travels and is stable.</li>
<li>The <strong>kaon</strong> is stable in our accelerator experiments.</li>
<li>The <strong>pion</strong> is also stable.</li>
</ul>
<p>They fly out from the decay without any distraction, and we see their tracks clearly through all detectors. We observe them pointing away from the primary interaction.</p>
<hr>
<p>There is roughly a <strong>10-millimeter shift</strong> in <span class="math inline">\Lambda_c</span> flight distance between the primary vertex and the secondary vertex—about one centimeter. This is due to the boost and the fact that <span class="math inline">\Lambda_c</span> in the laboratory frame lives longer than in its rest frame.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The observed flight path is explained by: <span class="math display">\Delta x = \gamma v \tau_0</span> where <span class="math inline">\gamma = E_{\Lambda_c}/m_{\Lambda_c}</span> is the Lorentz factor.</p>
</div>
</div>
</div>
<p>It is produced with several hundred GeV in proton-proton collisions at the LHC. This is a very clean decay, and we have studied it extensively.</p>
<hr>
<p>Here is the experimental result of the analysis, which closely resembles the data. If I showed you the actual experimental data, you wouldn’t distinguish it from this plot because the statistics are so high that the distribution is very smooth.</p>
<p>On the <strong><span class="math inline">x</span>-axis</strong>, I have the invariant mass squared of the proton and kaon: <span class="math display">m_{pK}^2 = (p_p + p_K)^2</span></p>
<p>On the <strong><span class="math inline">y</span>-axis</strong>, I have the invariant mass squared of the kaon and pion: <span class="math display">m_{K\pi}^2 = (p_K + p_\pi)^2</span></p>
<p>All allowed kinematic values for the decay are shown in color. The white area around it corresponds to kinematics where energy and momentum conservation cannot be satisfied.</p>
<hr>
<p>If I select a point inside the plot, I can compute the angles between particles and their momenta, reconstructing the full 3D decay configuration. But if you give me kinematics in the white area, I immediately see that energy conservation is violated—it’s impossible. This is why the range of possible invariant masses is limited, and this surface is called the <strong>Dalitz plot</strong>.</p>
<hr>
<p>This is how we explore the kinematics. Different colors on the plot indicate different probabilities for the decay to occur in specific kinematic configurations. We measure the decay, reconstruct the particle tracks, and determine from which kinematic point it originated because there’s a direct mapping between the four-vectors and the Dalitz plot coordinates.</p>
<p>It turns out that certain kinematics are more probable than others. Particles prefer specific momentum configurations.</p>
<hr>
<p>For this decay, for example, one kinematic configuration is more likely than another. You should be able to identify this pattern in the plot. Let’s take a moment to find it.</p>
<p>The hint is that particles are aligned in one line at the plot’s boundary. Inside the surface, they always have an angle between them, but at the boundary, they become collinear.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>At the Dalitz plot boundaries: <span class="math display">\theta_{ij} = 0 \text{ or } \pi \text{ between particles}</span></p>
</div>
</div>
</div>
<p>Think: how do you maximize the invariant mass, and where does this point lie on the boundary?</p>
<hr>
</section>
<section id="maximizing-and-minimizing-mass-in-three-body-decay-kinematics" class="level3" data-number="0.3">
<h3 data-number="0.3" class="anchored" data-anchor-id="maximizing-and-minimizing-mass-in-three-body-decay-kinematics"><span class="header-section-number">0.3</span> Maximizing and Minimizing Mass in Three-Body Decay Kinematics</h3>
<p>Any thoughts? I think you should be in the bottom right because we should maximize the mass of the PK. There are three momenta going out there. The three momenta are in opposite directions, so the three-momentum of the sum should be as small as possible.</p>
<p>If we add both momentum vectors, the forward momentum—the sum of the squares—should be as large as possible. We should be on the right of our diagram. If we apply and find… The same direction should be on the lowest.</p>
<p>You argue that this mass, on the y-axis, should be as small as possible. Why? Because the three momenta are in line, and we subtract them. If you go to their rest frame, the K and π fly next to each other. Their relative momentum is small. If you boost to their rest frame, they might both be at rest. Their mass would just be the sum of the masses, so it’s minimum.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Relation for Invariant Masses in Three-Body Decay</strong>: For a decay like <span class="math inline">\Lambda_c \to p K \pi</span>, the invariant masses satisfy: <span class="math display">
m_{12}^2 + m_{23}^2 + m_{13}^2 = m_{\Lambda_c}^2 + m_p^2 + m_K^2 + m_\pi^2
</span> where <span class="math inline">m_{ij}</span> are the invariant masses of particle pairs.</p>
</div>
</div>
</div>
<p>What you’re saying is correct. We are looking for the minimal mass of the kinematic. Let’s figure out what this point corresponds to. There is kinematics like this: two particles with maximal momentum are at rest and go in opposite directions. That corresponds to this one.</p>
<p>This plot is from experimental data. In the experiment, we would reconstruct such a case because we would not detect the proton. This is the lab frame, but everything we measure is in the lab frame where everything is boosted. Even though the proton is at rest in the lab frame, it’s already boosted.</p>
<hr>
<p>This point is the maximum mass. They have maximum momentum and go back-to-back, so this is the maximum mass. This one minimizes the mass. For the three-body decay, there is a similar way to define the angle.</p>
<p>Let me show you the setup. I’m using proton, K, and π. I want to fix the mass of the K-π system. I would like to explore that by changing the mass of the proton.</p>
<p>Think of this in the center-of-momentum frame and boost to the K-π rest frame. In the K-π rest frame, they go back-to-back. In the center-of-momentum frame, three particles are arranged such that the sum of the three-momenta is zero.</p>
<p>Once I boost, the <span class="math inline">\Lambda_c</span> has non-zero momentum. The K and π also have non-zero momentum, but since I am in their rest frame, these two momenta add to zero. If I fix the mass of the system and explore phase space along the line where the mass of this pair is fixed, the length of these vectors is fixed.</p>
<p>What is changing? Only the angle <span class="math inline">\theta</span>. I explore the whole range of the angle from <span class="math inline">0</span> to <span class="math inline">\pi</span>. At one corner, <span class="math inline">\theta = 0</span>; at the other, <span class="math inline">\theta = \pi</span>.</p>
<hr>
<p>The right should be zero and the left… Let’s see how you get to that. We fixed the setup where the proton and K-π go in opposite directions. This has the maximum mass of the proton-K system.</p>
<p>For our new setup, as the length of all vectors is fixed, we can only rotate. The dependence of the mass of two particles on <span class="math inline">\theta</span> is such that the wider the angle, the bigger the mass. For the proton-K system, <span class="math inline">\theta = 0</span> gives a very high mass. If they go almost in the same direction, they have a small mass.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Invariant Mass Relation for Fixed <span class="math inline">m_{K\pi}</span></strong>: <span class="math display">
m_{pK}^2 = m_{\Lambda_c}^2 + m_K^2 + m_\pi^2 - m_{K\pi}^2 - 2E_{K\pi}E_p + 2|\vec{p}_{K\pi}||\vec{p}_p|\cos\theta
</span> where <span class="math inline">E_i</span> and <span class="math inline">\vec{p}_i</span> are energies/momenta in the <span class="math inline">\Lambda_c</span> rest frame.</p>
</div>
</div>
</div>
<p>I can do the same with the other half. Let me fix the mass of the proton-K system again. The most straightforward way to analyze is to go to the rest frame of the proton-K system, where everything is fixed. Then scan along this line by changing the angle of this pair with respect to the rest.</p>
<p>The lines describe the setup where you change the angle in one frame or another. There is a third variable in the 2-to-2 scattering called U, but it’s more symmetric. For three particles, there is the mass of the pion-proton system.</p>
<p>If I fix the mass of this system and scan the angle, this is easy to understand from the relation that U is a linear combination of the two. The coefficients are one, so it’s a diagonal in this plot.</p>
<hr>
<p>This line is the mass of the pion-proton system fixed. I go from one corner to another, changing the representation. The representation we use in experimental analysis for the Dalitz plot has the mass of one pair on the x-axis and the other on the y-axis.</p>
<p>In the homework, you have an exercise with a more symmetric Dalitz plot where all variables enter symmetrically. This uses properties of an equilateral triangle: every point inside has distances to the sides that sum to a constant.</p>
<p>The variables—masses of particles—are the distances to the sides. I can look at it like this or like that. This is a super symmetric, nice representation. Essentially, it’s the same as this.</p>
<p>They’re not matching because one and another… Wait, should they match? It’s a linear transformation, skewed. To plot this, I had to find the relation between Cartesian coordinates and the heights of the triangle.</p>
<p>What appears is <span class="math inline">\sqrt{3}/2</span> because of the 60° angles. This is a nice symmetric representation, but the other is more common and easier to plot. Both represent the kinematics.</p>
<p>The objective is to understand the dynamics and processes guiding this interaction. Looking ahead, we realize this process is not just <span class="math inline">\Lambda_c</span> decaying to three particles but proceeding via intermediate resonances.</p>
<p>For a short moment, two particles form an intermediate state that dissociates, increasing the decay probability. These two particles interact more at certain energies, so the probability increases.</p>
<hr>
<p>You might have seen cross sections for two-particle resonances with bumps known as hadronic resonances. The physics is that the quantum numbers of the system match some resonance.</p>
<p>By adjusting the energy, you explore how likely the particles are to interact. If there is an intermediate resonance, the system resonates at this energy, and the probability increases.</p>
<p>This leads to bent structures in the Dalitz distribution. Projected onto one axis, you see a resonance-like shape. These bent structures appear in all three pairs.</p>
<p>Why is there a bigger probability increase when the kaon and pion are near resonance? Let’s understand the lines. We’ll come back to this in two lectures.</p>
<p>All horizontal lines—which resonances are these? In which mass distribution? Horizontal lines in the blue plot correspond to fixed mass for <span class="math inline">K\pi</span>. These are <span class="math inline">K^*</span> resonances.</p>
<p>Now, the vertical lines—in which system? When changing <span class="math inline">K\pi</span>, I scan a certain energy. This corresponds to fixed mass of the proton and <span class="math inline">K\pi</span>.</p>
<p>The lines correspond to resonances in <span class="math inline">K\pi</span>, proton-K, and pion-proton. The other plot helps because the lines are parallel to the sides of the triangle.</p>
<p>This line is the same as this one, parallel to one side. The lambda resonances are parallel to another side. The delta resonance is parallel to the third side.</p>
<hr>
<p>Okay, questions on the angular distribution. To move past this, let’s discuss the angular distribution for a decay within one band.</p>
<p>The kinematics: traversing the Dalitz plot while keeping the mass fixed changes the angle. This is the kinematics.</p>
<p>In the rest frame of <span class="math inline">K\pi</span>, traversing phase space changes this angle. The angle dependence indicates inhomogeneity. Within the band, one edge might have a different probability than the other.</p>
<p>Particles might prefer to be aligned rather than perpendicular. This happens because particles have spin. The intermediate resonance, like <span class="math inline">K^*</span>, is not scalar—it has spin.</p>
<p>Spin causes inhomogeneity in angular distributions and decay spectra.</p>
<p>Angular distribution is a powerful tool to understand particle properties. It measures spin, parity, and other quantum numbers.</p>
<p>Higher-spin particles produce bumpier angular distributions. Scalar particles produce no asymmetries.</p>
<p>In the rest frame of the decay, examining the ratio of aligned kinematics reveals spin information.</p>
<p>For most discovered particles, quantum numbers are unknown. We find them as bumps, then determine quantum numbers via angular distributions.</p>
<p>Often, it’s as simple as looking for minima or nodes in the Dalitz plot. Nodes indicate spin: one node for spin-1, two for spin-2, etc.</p>
<p>For non-scalar particles, it’s more complicated. The proton has spin-½; kaon and pion are spin-0. The <span class="math inline">\Lambda_c</span> has spin-½ like the proton.</p>
<p>If we don’t polarize the initial state or measure the final spin, everything is averaged. No minima or nodes remain—just smeared distributions.</p>
</section>
<section id="rotations-spin-projections-and-wigner-d-functions-in-quantum-systems" class="level3" data-number="0.4">
<h3 data-number="0.4" class="anchored" data-anchor-id="rotations-spin-projections-and-wigner-d-functions-in-quantum-systems"><span class="header-section-number">0.4</span> Rotations, Spin Projections, and Wigner <span class="math inline">D</span>-Functions in Quantum Systems</h3>
<p>A particle with spin can have <span class="math inline">2J + 1</span> projections to the quantization axis. Consider a particle with spin <span class="math inline">J</span>. There is a <span class="math inline">z</span>-axis that quantizes the spin, and this <span class="math inline">z</span>-axis measures the projection <span class="math inline">J_z</span>. The state <span class="math inline">|JM\rangle</span> can be thought of as a vector with <span class="math inline">2J + 1</span> components. All operators in this case are matrices that act on these vectors, producing either the same state with an eigenvalue or a mixture of states.</p>
<p>When a rotation acts on the state, it produces not a single state but a mixture of states. In classical physics, rotating a vector in space can align it to a specific projection, but in quantum mechanics, this is not the case. Most rotations result in a superposition of all possible states.</p>
<p>The coefficients for these superpositions are tabulated and known as <strong>Wigner <span class="math inline">D</span>-functions</strong>. Let me be more concrete. I will rotate about the <span class="math inline">Y</span>-axis. The coordinate system consists of <span class="math inline">X</span>, <span class="math inline">Y</span>, and <span class="math inline">Z</span>, forming a right-handed triple. I will rotate the state <span class="math inline">|JM\rangle</span> about the <span class="math inline">Y</span>-axis.</p>
<p>The operator <span class="math inline">J_+</span> is represented as <span class="math inline">\begin{pmatrix} 0 &amp; 1 \\ 0 &amp; 0 \end{pmatrix}</span>, and <span class="math inline">J_-</span> is <span class="math inline">\begin{pmatrix} 0 &amp; 0 \\ 1 &amp; 0 \end{pmatrix}</span>. The <span class="math inline">J_y</span> operator has zeros on the diagonal and off-diagonal elements above and below. To apply the rotation, we take the matrix exponential of <span class="math inline">J_y</span>. This is already computed, and the coefficients <span class="math inline">C</span> depend on the initial state, which is why the indices <span class="math inline">JM</span> are kept in the notation.</p>
<p>For example, suppose we have a spin-1 particle initially perpendicular to the <span class="math inline">Y</span>-axis and rotated by 30 degrees. The resulting state will be a superposition of <span class="math inline">|JM\rangle</span> states aligned along the <span class="math inline">Y</span>-axis. The Wigner <span class="math inline">D</span>-functions provide the coefficients for this superposition.</p>
<p>The general form of the <span class="math inline">D</span>-function for any rotation <span class="math inline">R</span> is given by Euler angles. In particle physics conventions, we first rotate by <span class="math inline">\phi</span> about the <span class="math inline">Z</span>-axis, then by <span class="math inline">\theta</span> about the <span class="math inline">Y</span>-axis, and finally by <span class="math inline">\gamma</span> about the <span class="math inline">Z</span>-axis again. This sequence describes any orientation in space. The <span class="math inline">D</span>-function decomposes into three parts, with the most complex part coming from the <span class="math inline">Y</span>-axis rotation. The <span class="math inline">Z</span>-axis rotations introduce simple phase factors:</p>
<p><span class="math display">
D^J_{M'M}(\gamma, \theta, \phi) = e^{-i\gamma M'} d^J_{M'M}(\theta) e^{-i\phi M}.
</span></p>
<hr>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Formula</strong>: The Wigner <span class="math inline">D</span>-function for a general rotation (Euler angles <span class="math inline">\alpha, \beta, \gamma</span>) is: <span class="math display">
D^J_{M'M}(\alpha, \beta, \gamma) = e^{-iM'\alpha} d^J_{M'M}(\beta) e^{-iM\gamma}.
</span></p>
</div>
</div>
</div>
<hr>
<p>Let’s take a simple example: spin-1/2. If I rotate the state <span class="math inline">|1/2, 1/2\rangle</span> by 30 degrees about the <span class="math inline">Y</span>-axis, the result is a superposition of <span class="math inline">|1/2, 1/2\rangle</span> and <span class="math inline">|1/2, -1/2\rangle</span>. The coefficients for this rotation can be found in the same tables as the Clebsch-Gordan coefficients, as both are related to the <span class="math inline">SU(2)</span> group.</p>
<p>For <span class="math inline">j = 1/2</span>, the <span class="math inline">D</span>-matrix is:</p>
<p><span class="math display">
D^{1/2}_{m'm}(\theta) = \begin{pmatrix} \cos(\theta/2) &amp; -\sin(\theta/2) \\ \sin(\theta/2) &amp; \cos(\theta/2) \end{pmatrix}.
</span></p>
<p>For 30 degrees (<span class="math inline">\theta/2 = 15^\circ</span>), the coefficients are <span class="math inline">\cos(15^\circ)</span> and <span class="math inline">\sin(15^\circ)</span>.</p>
<hr>
<ul>
<li>Can you compute any rotation of the spin projection?</li>
<li>The convention is important—note the minus sign.</li>
<li>If you want to compute the matrix exponential yourself, you can use Python or Julia.</li>
<li>Alternatively, you can look up tabulated <span class="math inline">D</span>-functions, but be cautious with software like Mathematica, as it may use different conventions.</li>
<li>Wikipedia is reliable for checking conventions.</li>
<li>The <span class="math inline">D</span>-functions are correctly implemented in SymPy (Python) and ROOT.</li>
</ul>
<hr>
<p>What we’ve discussed so far is about rotations and the rotational group, not weak or strong interactions. This is remarkable because angular distributions in particle decays are determined by <strong>rotational symmetry</strong>, not by the details of the interactions. The only input from strong interactions is the preference for certain spin states. The decay asymmetries and kinematics are governed by the quantum group properties. This allows us to construct general formulas for decay chains and predict angular distributions.</p>
<hr>
<p>Now let’s model the “blob” in the decay process. Assume a cascade decay where the initial particle decays into an intermediate particle <span class="math inline">X</span> with spin <span class="math inline">J</span>, which then decays into particles 1 and 2. The amplitude involves summing over intermediate spins and depends on the dimensions:</p>
<p><span class="math display">
(2j_0 + 1) \times (2j_1 + 1) \times (2j_2 + 1) \times (2j_3 + 1).
</span></p>
<p>If a particle has spin 0, its dimension is 1.</p>
<p>The general formula for the amplitude has two parts:</p>
<ol type="1">
<li>A model-independent part from rotational symmetry.</li>
<li>Dynamics-dependent terms <span class="math inline">H</span> from weak, strong, or electromagnetic interactions.</li>
</ol>
<p>The <span class="math inline">H</span> terms encapsulate the physics of the interactions, while the rest is determined by rotational properties. The helicity states <span class="math inline">\lambda</span> are defined with spin quantized along the direction of motion.</p>
<hr>
<p>Consider particle <span class="math inline">X</span> with spin projection <span class="math inline">\lambda_X</span>. When it decays into particles 1 and 2, the quantization axis must be adjusted to match the decay direction. This adjustment is done by rotating the spin state of <span class="math inline">X</span>.</p>
<p>In aligned kinematics (where <span class="math inline">\phi = \theta = 0</span>), the rotation simplifies. The amplitude reduces to:</p>
<p><span class="math display">
A = \sum_{\lambda_X} H_{\lambda_0 \lambda_X \lambda_3} \cdot D^{J_X}_{\lambda_X, \lambda_1 - \lambda_2}(\theta, \phi) \cdot H_{\lambda_X \lambda_1 \lambda_2}.
</span></p>
<p>For zero angles, the <span class="math inline">D</span>-function becomes a delta function <span class="math inline">\delta(\lambda_0 - (\lambda_X - \lambda_3))</span>, enforcing angular momentum conservation.</p>
<hr>
<p>To predict angular distributions, we need the values of <span class="math inline">H</span>. Often, these are approximated as constants in initial analyses. The differential decay rate is:</p>
<p><span class="math display">
\frac{d\Gamma}{d\cos\theta} \propto |A|^2.
</span></p>
<p>The distribution can be flat, parabolic, or another shape, depending on the spin.</p>
<p>Experimentally, we measure <span class="math inline">|A|^2</span> averaged over initial and final spins. To analyze data, we project the distribution onto Legendre polynomials, a technique called <strong>partial wave analysis</strong>. This helps extract information about the underlying dynamics without knowing <span class="math inline">H</span> explicitly.</p>
<hr>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Practical Note</strong>: For further reading on canonical vs.&nbsp;helicity states, refer to Chapter 4 of Martin Spearman’s <em>Elementary Particle Theory</em>.</p>
</div>
</div>
</div>
<hr>
<p>Finally, here’s an exercise: I’ve provided Dalitz plots from CLEO and BaBar without labels. Your task is to identify the decays based on kinematics. The axes are labeled, but the particles are not named. Use your knowledge of kinematics to deduce the masses and possible decay channels.</p>
</section>
<section id="addressing-an-issue-and-scheduling-follow-up" class="level3" data-number="0.5">
<h3 data-number="0.5" class="anchored" data-anchor-id="addressing-an-issue-and-scheduling-follow-up"><span class="header-section-number">0.5</span> Addressing an Issue and Scheduling Follow-Up</h3>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><em>This portion of the transcript appears to be administrative dialogue about scheduling and materials distribution.</em></p>
</div>
</div>
</div>
<ul>
<li><strong>Speaker 1:</strong> I have to leave because I have an issue.</li>
<li><strong>Speaker 2:</strong> You don’t want to take it? No.</li>
</ul>
<p><em>Exchange about assignments:</em></p>
<ul>
<li><strong>Speaker 1:</strong> It’s a kind of homework.</li>
<li><strong>Speaker 2:</strong> Oh, sorry.</li>
</ul>
<p><em>Follow-up arrangement:</em></p>
<ul>
<li><strong>Speaker 1:</strong> Okay, come with me and I’ll give it to you from my office.</li>
<li><strong>Speaker 1:</strong> And you guys as well.</li>
</ul>
<p><em>Closing remarks:</em></p>
<ul>
<li><strong>Speaker 1:</strong> Thanks a lot for coming, and sorry for being slightly late.</li>
<li><strong>Speaker 1:</strong> Will you have time tomorrow at 8am? Leave.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">

<title>(2024) Lecture 12 – Hadron Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 12.8em;
  margin: 0 12.8em 12.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-065a5179aebd64318d7ea99d77b64a9e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d3a565c23c4d3b0e7c030e96a8964f3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pion-decay-dynamics-chirality-suppression-and-the-muon-magnetic-moment" id="toc-pion-decay-dynamics-chirality-suppression-and-the-muon-magnetic-moment" class="nav-link active" data-scroll-target="#pion-decay-dynamics-chirality-suppression-and-the-muon-magnetic-moment"><span class="header-section-number">12.1</span> Pion Decay Dynamics, Chirality Suppression, and the Muon Magnetic Moment</a></li>
  <li><a href="#proton-beam-to-muon-spin-precession-measuring-anomalous-magnetic-moment" id="toc-proton-beam-to-muon-spin-precession-measuring-anomalous-magnetic-moment" class="nav-link" data-scroll-target="#proton-beam-to-muon-spin-precession-measuring-anomalous-magnetic-moment"><span class="header-section-number">12.2</span> Proton Beam to Muon Spin Precession: Measuring Anomalous Magnetic Moment</a></li>
  <li><a href="#muon-polarization-anomalous-magnetic-moment-and-hadronic-contributions-in-g-2-experiments" id="toc-muon-polarization-anomalous-magnetic-moment-and-hadronic-contributions-in-g-2-experiments" class="nav-link" data-scroll-target="#muon-polarization-anomalous-magnetic-moment-and-hadronic-contributions-in-g-2-experiments"><span class="header-section-number">12.3</span> Muon Polarization, Anomalous Magnetic Moment, and Hadronic Contributions in <span class="math inline">g-2</span> Experiments</a></li>
  <li><a href="#dispersion-relations-and-analyticity-in-complex-analysis" id="toc-dispersion-relations-and-analyticity-in-complex-analysis" class="nav-link" data-scroll-target="#dispersion-relations-and-analyticity-in-complex-analysis"><span class="header-section-number">12.4</span> Dispersion Relations and Analyticity in Complex Analysis</a></li>
  <li><a href="#dispersion-relations-cross-sections-and-the-r-ratio-in-hadronic-processes" id="toc-dispersion-relations-cross-sections-and-the-r-ratio-in-hadronic-processes" class="nav-link" data-scroll-target="#dispersion-relations-cross-sections-and-the-r-ratio-in-hadronic-processes"><span class="header-section-number">12.5</span> Dispersion Relations, Cross Sections, and the R Ratio in Hadronic Processes</a></li>
  <li><a href="#challenges-in-hadronic-contributions-and-the-weakening-new-physics-signal" id="toc-challenges-in-hadronic-contributions-and-the-weakening-new-physics-signal" class="nav-link" data-scroll-target="#challenges-in-hadronic-contributions-and-the-weakening-new-physics-signal"><span class="header-section-number">12.6</span> Challenges in Hadronic Contributions and the Weakening New Physics Signal</a></li>
  <li><a href="#seeking-sources-on-sun-representation-theory-via-young-tableaux" id="toc-seeking-sources-on-sun-representation-theory-via-young-tableaux" class="nav-link" data-scroll-target="#seeking-sources-on-sun-representation-theory-via-young-tableaux"><span class="header-section-number">12.7</span> Seeking Sources on SU(N) Representation Theory via Young Tableaux</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">(2024) Lecture 12</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Spring 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Presenter</strong>: Mikhail Mikhasenko</p>
<p><strong>Note Taker</strong>: Ilya Segal</p>
<section id="pion-decay-dynamics-chirality-suppression-and-the-muon-magnetic-moment" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="pion-decay-dynamics-chirality-suppression-and-the-muon-magnetic-moment"><span class="header-section-number">12.1</span> Pion Decay Dynamics, Chirality Suppression, and the Muon Magnetic Moment</h3>
<p>We are finishing the lecture cycle. Two more to go. Today is the month before last. However, content-wise, today will be more on physics, and next week I would like to discuss meta-issues and how the hadron community functions. I will give you a little bit of background on how research is structured in the field, how collaborations work, and what scientists actually do in the hadron physics domain. There will be less on physics next time. Perhaps I will spend the first 20 minutes reviewing recent discoveries, what experiments have brought up, and what the hadron community is currently working on.</p>
<hr>
<p>But today I would like to talk more about physics and still have to write formulas and discuss how particle physics is used outside of particle physics, how it is an important part of many other studies. I considered dedicating one lecture to <strong>CP violation</strong>, where particle physics plays a key role. Another subject I was considering is the <strong>muon magnetic moment</strong> and its hadronic contributions. That’s what we will discuss. I decided on this fundamental topic because it touches on several subjects we’ve already covered. The exercise sheet is on the <strong>R ratio</strong>, something we postponed earlier. Now we enhance it with more problems and discuss it at a more advanced level.</p>
<hr>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Key formulas discussed in this lecture:</p>
<ul>
<li>Weak interaction vertex: <span class="math inline">\mathcal{L}_{\text{weak}} \propto \bar{\psi}\gamma^\mu (1 - \gamma_5)\psi</span></li>
<li>Pion decay amplitude suppression: <span class="math inline">\mathcal{M} \propto m_\ell / E_\ell</span></li>
<li>Muon magnetic moment: <span class="math inline">\vec{\mu} = g \left( \frac{e}{2m} \right) \vec{S}</span></li>
</ul>
</div>
</div>
</div>
<hr>
<p>I would like to start today’s lecture with a short recap. Let’s revisit our discussion of <strong>helicity and chirality</strong> and examine pion decay: <span class="math inline">\pi^+ \to \mu^+ \nu_\mu</span>. I would like you to compare this decay. Start by drawing this two-body decay in the rest frame of the pion, indicating momenta and chirality. The vertex is a weak interaction, so the produced particles have definite chiral properties—left or right. On this diagram, chirality is related to spin orientation in the high-mass limit. Given these chiral configurations, what are the ratios of the matrix elements? Which phase space is bigger? And which decay is more likely for the pion? Let’s take three minutes.</p>
<hr>
<p>Let’s discuss the first question. Who found this obvious? No one? That’s fine—we have something to discuss. Draw the center-of-momentum decay kinematics and indicate chirality. Note: it’s a neutrino, not an antineutrino, because the electron comes with an antineutrino. The weak interaction vertex has a <strong><span class="math inline">V-A</span> structure</strong>, <span class="math inline">\gamma^\mu (1 - \gamma_5)</span>, which projects the quark current to left-handedness. Here, the vertex produces a left-handed positron and a left-handed neutrino.</p>
<p>For the right-handed positron, the left-handed component is suppressed by its mass. The neutrino is massless, so it’s purely left-handed. For the right-handed particle, the spin aligned with momentum dominates. For the left-handed particle, it’s the opposite. Both particles have spin <span class="math inline">\frac{1}{2}</span>, and their spins add to one, which is incompatible with the pion’s spin-zero nature. Other configurations are possible, but flipping the spin of the right-handed particle is suppressed by <span class="math inline">\frac{m}{E}</span>. The neutrino, being massless, has no opposite component, but the positron does. The <span class="math inline">v_R^+</span> component is suppressed by <span class="math inline">\frac{m}{E}</span>.</p>
<hr>
<p>This leads to the second question: The matrix elements for the electron and muon are suppressed differently because their masses differ. The lighter the particle, the stronger the suppression—for the electron, it’s severe, but for the muon, especially since the pion mass is close to the muon mass, the chirality suppression is less pronounced. The correct answer is that the ratio is much less than one, explaining why the pion decays predominantly to muons, not electrons.</p>
<p>For phase space, the number of angular configurations is the same, but the energy release differs. The bigger the energy release, the larger the phase space. For the muon, most of the pion mass goes into kinetic energy because the neutrino is massless and the electron nearly so. The phase space is larger for the muon, but this doesn’t compensate for the suppression. The phase space integral is <span class="math inline">\frac{s - m_e^2}{s - m_\mu^2}</span>, but this doesn’t change the conclusion.</p>
<hr>
<p>The dominant decay of the pion is <span class="math inline">\pi^+ \to \mu^+ \nu_\mu</span>. This is <strong>important physics</strong>—it’s how parity violation was discovered. The muon is produced polarized because the pion has no spin, and the neutrino escapes undetected. The muon’s polarization can be measured because its decay <span class="math inline">\mu^+ \to e^+ \nu_e \bar{\nu}_\mu</span> is self-analyzing. The electron’s angular distribution reveals the muon’s polarization. If the muon is polarized, the electron prefers to align with the spin direction. This setup was used in 1967 to confirm parity violation.</p>
<hr>
<p>Later, the same technique measured the muon’s magnetic moment. Recall from the second lecture that the magnetic moment of a particle describes its interaction with a magnetic field. For a point-like fermion, it’s given by:</p>
<p><span class="math display">
\vec{\mu} = g \left( \frac{e}{2m} \right) \vec{S}, \quad \text{where} \quad g \approx 2
</span></p>
<p>For the proton, we found <span class="math inline">g \approx 2.8</span>, indicating it’s composite. But the muon is elementary, so we expect <span class="math inline">g = 2</span>. However, quantum corrections make <span class="math inline">g</span> slightly larger. The deviation is quantified by <span class="math inline">a_\mu = \frac{g - 2}{2}</span>, one of the most precisely known numbers in physics.</p>
<hr>
<p>The leading QED correction, calculated by Schwinger, is:</p>
<p><span class="math display">
a_\mu = \frac{\alpha}{2\pi}
</span></p>
<p>Higher-order terms (<span class="math inline">\alpha^2, \alpha^3</span>, etc.) have been computed up to <span class="math inline">\alpha^5</span>. Modern calculations use computers due to the complexity. The experimental setup involves trapping muons in a magnetic field ring. The muon’s spin precesses at <span class="math inline">\omega_s = \omega_c (1 + a_\mu \gamma)</span>, where <span class="math inline">\omega_c</span> is the cyclotron frequency. The difference <span class="math inline">\omega_s - \omega_c</span> isolates <span class="math inline">a_\mu</span>, allowing precise measurements. This technique, pioneered decades ago, remains critical for testing QED and probing new physics.</p>
</section>
<section id="proton-beam-to-muon-spin-precession-measuring-anomalous-magnetic-moment" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="proton-beam-to-muon-spin-precession-measuring-anomalous-magnetic-moment"><span class="header-section-number">12.2</span> Proton Beam to Muon Spin Precession: Measuring Anomalous Magnetic Moment</h3>
<p>The experiment is as follows. You start with the <strong>proton beam</strong>—that’s a hydrogen beam, the easiest beam we can get. You hit the target and you get a bunch of pions flying forward. You collect the pions and direct them towards your ring.</p>
<hr>
<p>Here is the tunnel through which the pions from the secondary vertex come. In this tunnel, they decay. Some of the pions convert to muons, and the muons are trapped. In the ring, they start moving.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The muon’s anomalous magnetic moment (<span class="math inline">a_\mu</span>) is central to this experiment: <span class="math display">
a_\mu = \frac{g_\mu - 2}{2}
</span> where <span class="math inline">g_\mu</span> is the g-factor of the muon.</p>
</div>
</div>
</div>
<hr>
<p>Since pions produce <strong>polarized muons</strong>, they already have exactly the configuration we want. There is a muon, and there is a spin. By applying a magnetic field, this setup starts working. The muon moves along the circle, and the spin begins precessing.</p>
<hr>
<p>We measure the spin orientation by looking at the decay electrons. Muons go along the circle and decay. There are millions of particles in the bunch, and as they move, some muons decay.</p>
<hr>
<p>Inside the circle, there are <strong>calorimeters</strong>—lead glass calorimeters, as I checked this morning. It’s a big block, a typical setup used in experiments like COMPASS. Lead glass is a material doped with lead to increase its atomic number (<span class="math inline">Z</span>). When a particle enters, it deposits all its energy inside. Because it’s glass, it’s transparent to light. You place this heavy block of glass with a photosensor at the end. A particle comes in, leaves energy, and the sensor collects it.</p>
<hr>
<p>These calorimeters measure the flux of electrons.</p>
<ul>
<li>If the spin points <strong>outwards</strong>, you detect fewer electrons.</li>
<li>If the spin points <strong>inwards</strong>, you detect more electrons. Along the circle, you see fluctuations in the energy deposit.</li>
</ul>
<hr>
<p>In <strong>g-2 measurements</strong>, the plot shows time on the x-axis and energy deposit—or something similar. People cut this piece and start over.</p>
<p>The frequency of rotation stays the same. To be precise, the frequency doesn’t change. It is determined by the charge of the muon and the magnetic field.</p>
<hr>
<p>Out of the muons in the batch, some decay. The overall energy deposited decreases exponentially as: <span class="math display">
N(t) = N_0 e^{-t/\tau_\mu}
</span> where <span class="math inline">\tau_\mu</span> is the muon lifetime.</p>
<p>This decay is modulated by the spin precession, fluctuating up and down. The signal follows: <span class="math display">
S(t) = N_0 e^{-t/\tau_\mu} [1 + A \cos(\omega_a t + \phi)]
</span> where <span class="math inline">\omega_a</span> is the <strong>anomalous precession frequency</strong>.</p>
<hr>
<p>You collect these statistics for three years, and then you have the number.</p>
<p>The analysis is <strong>blinded</strong>. Two years ago, there was a big press release for the new g-2 measurements. Before starting, the analysts wrote the real frequency on a piece of paper in an envelope. At the press conference, they unblinded the analysis. They opened the envelope, entered the frequency, and revealed the measured numbers.</p>
<hr>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The relationship between the anomalous magnetic moment and precession frequency is: <span class="math display">
a_\mu = \frac{\omega_a}{\omega_c} = \frac{\omega_a m_\mu}{eB}
</span> This is the key equation for extracting <span class="math inline">a_\mu</span> from the measured <span class="math inline">\omega_a</span>.</p>
</div>
</div>
</div>
</section>
<section id="muon-polarization-anomalous-magnetic-moment-and-hadronic-contributions-in-g-2-experiments" class="level3" data-number="12.3">
<h3 data-number="12.3" class="anchored" data-anchor-id="muon-polarization-anomalous-magnetic-moment-and-hadronic-contributions-in-g-2-experiments"><span class="header-section-number">12.3</span> Muon Polarization, Anomalous Magnetic Moment, and Hadronic Contributions in <span class="math inline">g-2</span> Experiments</h3>
<p>You’re measuring <span class="math inline">\omega_S</span>—it’s actually correct. What enters the field is really this variable.</p>
<p>These fluctuations—are they related to <span class="math inline">\omega_C</span> or not? As far as you explained, you would measure <span class="math inline">\omega_S</span> and plot as many data points as possible.</p>
<p>If the two velocities were exactly the same, the spin configurations would propagate identically, so nothing would change. Therefore, up and down fluctuations—no, this is <span class="math inline">\omega_C</span>.</p>
<p>The key point is that it’s a ratio, a difference that enters. This plot is sensitive to the difference, but I don’t see it now.</p>
<p>For some reason, I thought you saw a difference between them, but no. I’m not sure.</p>
<hr>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Physics Context</strong>: The discussion involves precision measurements of spin dynamics, where <span class="math inline">\omega_S</span> and <span class="math inline">\omega_C</span> represent frequencies related to spin and cyclotron motion, respectively. The difference between these frequencies is critical for observing effects like the anomalous magnetic moment (<span class="math inline">g-2</span>).</p>
</div>
</div>
</div>
<hr>
<p>The key question is: Are the other muons polarized when you shoot them into the ring? Does it matter? Muons? Yes, when they come up. Exactly.</p>
<p>In the vector boson binding case, this vertex is a weak interaction vertex, and it produces a certain chirality of the state. Muons are always polarized in the binding case. That’s really neat.</p>
<p>This spectacular experiment—the next generation is happening now. The most important concern in the setup is the homogeneity of the field. If the field is not exactly <span class="math inline">B</span> but slightly different, the integral over the magnetic field that the muon acquires while traveling changes, introducing uncertainty.</p>
<p>To achieve such precision—quantified in parts per billion (<strong>ppb</strong>)—is remarkable. Currently, the uncertainty is <strong>63 ppb</strong> in the experimental value, and the theoretical value is around <strong>100 ppb</strong>.</p>
<hr>
<p>You might ask, <em>“What does hadronic physics have to do with this?”</em> Hadronic corrections appear prominently in the theoretical calculation of the anomalous magnetic moment <span class="math inline">g-2</span>.</p>
<p>There are <strong>two major hadronic contributions</strong> to <span class="math inline">g-2</span>:</p>
<ol type="1">
<li><strong>Hadronic Vacuum Polarization (HVP)</strong>:</li>
</ol>
<ul>
<li>A photon produces hadrons and then turns back into a photon.</li>
<li>This is <em>running vacuum polarization</em>.</li>
</ul>
<ol start="2" type="1">
<li><strong>Hadronic Light-by-Light (HLbL) Scattering</strong>:</li>
</ol>
<ul>
<li>Light interacts with hadrons and re-emits light.</li>
<li>Mesons like <span class="math inline">\pi^0</span> and <span class="math inline">\eta</span> (which decay into two photons) contribute to HLbL.</li>
</ul>
<hr>
<p>The photon has quantum numbers <span class="math inline">J^{PC} = 1^{--}</span>. Which mesons share these quantum numbers?</p>
<ul>
<li><strong>Spin one</strong> means <strong>vector mesons</strong>. Examples include:</li>
<li><span class="math inline">\rho^0</span> (<span class="math inline">u\bar{u}</span>)</li>
<li><span class="math inline">\phi</span> (<span class="math inline">s\bar{s}</span>)</li>
<li><span class="math inline">J/\psi</span> (<span class="math inline">c\bar{c}</span>)</li>
<li><span class="math inline">\Upsilon</span> (<span class="math inline">b\bar{b}</span>)</li>
</ul>
<p>In the quark model, these mesons belong to the same multiplet. For instance, replacing the <span class="math inline">u</span>-quark with a <span class="math inline">c</span>-quark gives <span class="math inline">J/\psi</span>.</p>
<p>In the strange sector, the vector meson is <span class="math inline">\phi</span> (<span class="math inline">s\bar{s}</span>).</p>
</section>
<section id="dispersion-relations-and-analyticity-in-complex-analysis" class="level3" data-number="12.4">
<h3 data-number="12.4" class="anchored" data-anchor-id="dispersion-relations-and-analyticity-in-complex-analysis"><span class="header-section-number">12.4</span> Dispersion Relations and Analyticity in Complex Analysis</h3>
<p>The <strong>Cauchy theorem</strong> tells you that in the complex plane you can integrate in the manner of analyticity. The integral is equal to the integral of the function over <span class="math inline">S'</span>. This <span class="math inline">S'</span> is equal to the sum of the <span class="math inline">2\pi i</span> residues of the function at the poles. Does it look familiar? We discussed this already—that you can use this to have an integral representation of the function for any function in the domain of its analyticity.</p>
<p>You can write this in the following way, and what you do, actually, is manually introduce a pole by hand such that this integral would be equal. In this integral, it will be equal to the residue of the integrand. This function <span class="math inline">F</span> that is here is this ratio; it has one pole. Therefore, you have to take the function right at the pole, and that would make you substitute <span class="math inline">S</span> for <span class="math inline">S'</span>, and then it would make the derivation valid. This is known as the <strong>Cauchy theorem</strong>, and this is kind of a little consequence of it.</p>
<hr>
<p>Now, there is a <strong>trick</strong>, especially for real analytic functions. Imagine that you have a function that is real analytic in the domain below the cut, and then the cut starts at that threshold. We would like to use something like that to evaluate the value. So what I’m going to do is write this representation for this contour: my function <span class="math inline">G(S)</span> is equal to <span class="math inline">\frac{1}{2\pi i}</span> integral over contour <span class="math inline">C</span> of <span class="math inline">\frac{G(S_1)}{S_1 - S} dS_1</span>. This is my contour <span class="math inline">C</span>.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Property of Real Analytic Functions</strong> (cut discontinuity): <span class="math display">
G(S + i\epsilon) = G^*(S - i\epsilon) \quad \text{(for real } S \text{ below threshold)}
</span> implying <span class="math inline">\text{Re}\, G(S + i\epsilon) = \text{Re}\, G(S - i\epsilon)</span> and <span class="math inline">\text{Im}\, G(S + i\epsilon) = -\text{Im}\, G(S - i\epsilon)</span>.</p>
</div>
</div>
</div>
<p>I’m going to blow up the contour. Changing the contour does not change anything. The only singularity that I encounter is the one introduced by hand—it’s a pole in the center or somewhere inside of it. So I’m transforming my plane into the following contour. It has two contributions: the one that comes from the circle and the one from the cut. The one from the cut is actually evaluated along the real axis.</p>
<p>I’m going to use the property that <span class="math inline">G(S + i\epsilon)</span> (with <span class="math inline">\epsilon</span> infinitesimal) is related to <span class="math inline">G(S - i\epsilon)</span>. This is due to the <strong>real analyticity</strong>. It’s rather intuitively clear, but not necessarily so.</p>
<hr>
<p>Let’s consider an example just on the side. Any function with such a cut will be real analytic. We had an exercise on that. I want to have an <span class="math inline">x</span> domain, and then the function has a cut starting at one, going to the right, and the function should be real here. My favorite example is <span class="math inline">\sqrt{1 - x}</span>. But <span class="math inline">\sqrt{x}</span> could have a cut in the other direction. So I think I should do <span class="math inline">\sqrt{1 - x}</span>.</p>
<p>This function has a cut to the right; it starts at 1. If I put <span class="math inline">x = 0</span>, I can evaluate this, no problem. It’s real analytic because for negative <span class="math inline">x</span>, say <span class="math inline">x = -8</span>, then I have <span class="math inline">\sqrt{9} = 3</span>.</p>
<p>My claim is that <span class="math inline">G(x + i0)</span> has a real and imaginary part. If I calculate this for negative, it has the same real part and negative imaginary part. Let’s check it for some value. At <span class="math inline">x = 5</span>, <span class="math inline">G(5 + i0) = \sqrt{-4 - i0} = 2i</span>. Indeed, it’s a real analytic function. The value above and below the cut has the same real part and opposite imaginary parts.</p>
<p>That lets me write this integral as a principal value integral over the imaginary part. Plus, another thing I use is that the integral in one direction is equal to minus the integral in the other direction. That’s what gave me the minus sign here.</p>
<hr>
<p>If the function drops fast enough when <span class="math inline">S</span> goes to infinity, I can blow up my circle even more and drop the contribution from the circle. I forgot a <span class="math inline">2i</span> here—so here in the numerator should be <span class="math inline">2i</span>. This is a beautiful formula that we derived, known as a <strong>dispersion relation</strong>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Dispersion Relation</strong> (recovering a function from its imaginary part): <span class="math display">
G(S) = \frac{1}{\pi} \int_{\text{cut}} \frac{\text{Im}\, G(S')}{S' - S} \, dS'
</span> (Assumes <span class="math inline">G</span> vanishes sufficiently fast at infinity.)</p>
</div>
</div>
</div>
<p>This function allows us to recover the full function from its imaginary part. It’s quite amazing. It just tells you what the function is equal to here, and using this relation, I can give it to you anywhere in the complex plane.</p>
<p>It’s an advanced subject, the dispersion relation, but it’s part of the classwork. It’s a little exercise that helps you understand better how dispersion works.</p>
<hr>
<p>There is also the <strong>subtraction</strong>. People say we do this dispersion relation with one subtraction. It’s not just one, but two poles are introduced. Then it’s under the integral with the prime. This is the variable I integrate over, and then <span class="math inline">S - a</span>. Once you do that, you have to multiply this without the prime outside the integral. Then obviously this term is going to vanish once <span class="math inline">S = a</span>. Therefore, to have the correct relation, you need <span class="math inline">G(a)</span> here.</p>
<p>This is called a <strong>once-subtracted dispersion relation</strong>. The easiest subtraction is at zero. Then <span class="math inline">a = 0</span>, and you have just <span class="math inline">G(S) = G(0) + \frac{S}{\pi}</span> (and then an extra <span class="math inline">S</span> for the integration). That’s what you have to do when your condition for the high circle is not met—when your function does not decrease fast enough. You can still use this dispersion relation; you just have to do one subtraction or two subtractions.</p>
<p>The twice-subtracted version would be putting this to power two and then having it as well. Quite amazing—I can’t believe it works.</p>
<hr>
<p>Just look here. I can use this formulation for my <span class="math inline">\sqrt{1 - x}</span> function.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Example with <span class="math inline">\sqrt{1-x}</span></strong> (applied dispersion relation): <span class="math display">
\sqrt{1 - x} = 1 + \frac{x}{\pi} \int_{1}^{\infty} \frac{\text{Im}\, \sqrt{1 - x'}}{x'(x' - x)} \, dx'
</span> where <span class="math inline">\text{Im}\, \sqrt{1 - x'}</span> is non-zero only for <span class="math inline">x' &gt; 1</span>.</p>
</div>
</div>
</div>
<p>(Maybe just a technical question: By real analyticity, you mean that the function is real for real inputs up to the threshold?)</p>
<p>Exactly. And this implies the relation.</p>
<p>So I think we can also understand this in a way that suddenly—where is my drawing?—suddenly my function was real, and then an imaginary part appeared. The fact that it’s real in the vicinity when I go towards it means that the imaginary part will appear on one side with one sign and on the other side with the opposite sign. So that’s how to understand it.</p>
<p>The cut can only—analyticity can only introduce an imaginary part consistently from both sides of the cut, given that it was real here. Right? Would you believe that?</p>
<p>So <span class="math inline">\sqrt{1 - x}</span> is equal to the integral of <span class="math inline">\frac{\text{Im}\sqrt{1 - x'}}{\pi(x' - x)}</span>. And then I have to add here the value at zero, which is 1. Quite nontrivial—like, would you believe that if you just saw it? But mathematically, it works.</p>
<p>This is because we started with an analytic function. So this is analytic. We do the circle integral, we use… This can be evaluated explicitly. I could actually tell you what this imaginary part of the square root is—it’s just a Heaviside step function. So we could just have a real expression.</p>
<p>Mathematically surprising, but it works.</p>
</section>
<section id="dispersion-relations-cross-sections-and-the-r-ratio-in-hadronic-processes" class="level3" data-number="12.5">
<h3 data-number="12.5" class="anchored" data-anchor-id="dispersion-relations-cross-sections-and-the-r-ratio-in-hadronic-processes"><span class="header-section-number">12.5</span> Dispersion Relations, Cross Sections, and the R Ratio in Hadronic Processes</h3>
<p>Now we come back to the expression in the last minutes, and I’ll wrap up this sketch of how it works. We relate the imaginary part of this block, through the <strong>optical theorem</strong>, to the cross section:</p>
<p><span class="math display">
\sigma \propto \text{Im}\,\mathcal{M}
</span></p>
<p>The observable is given by the cross section. The cross section is the imaginary part.</p>
<p>You put the imaginary part in the numerator, perform the <strong>dispersion integral</strong>, and we obtain this contribution. It should now make more sense why we start at the threshold and why we extend to this global function.</p>
<hr>
<p>The polarization is an <strong>analytic function</strong> and only has the right-hand cut. It is real and smooth before the threshold. Once we cross the threshold, it develops a <strong>branch cut</strong>. We compute this polarization using the dispersion relation:</p>
<p><span class="math display">
\Pi(q^2) = \frac{1}{\pi} \int_{s_{\text{threshold}}}^\infty \frac{\text{Im}\,\Pi(s)}{s - q^2 - i\epsilon} ds
</span></p>
<p>and relate it to the cross section.</p>
<hr>
<p>The quantity <span class="math inline">R</span> is defined as:</p>
<p><span class="math display">
R(s) = \frac{\sigma(e^+e^- \to \text{hadrons})}{\sigma(e^+e^- \to \mu^+\mu^-)}
</span></p>
<p>The denominator is the <span class="math inline">\mu^+\mu^-</span> cross section calculated theoretically.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The <span class="math inline">R</span> ratio compares hadronic production to muon pair production in <span class="math inline">e^+e^-</span> collisions, serving as a probe for QCD dynamics and resonances.</p>
</div>
</div>
</div>
<p>This is not directly from experimental measurements, but the <span class="math inline">R</span> ratio we use here is consistent with experimental data. The theoretical calculations for this process are very close to what is measured in experiments. The exercise sheet provides the minor differences that arise.</p>
<hr>
<p>The <span class="math inline">R</span> ratio reveals all the resonances that can appear. Here is a plot showing the experimental measurement of <span class="math inline">R</span>. It is quite spectacular, as expected. It includes contributions from resonances like the <span class="math inline">\rho</span>, <span class="math inline">\phi</span>, and <span class="math inline">\Upsilon</span>.</p>
<p>There is also a <strong>background contribution</strong>. All resonances sit on top of this background. The background comes from hadronic contributions—quarks that hadronize not just into single pions or two pions, but into many particles.</p>
<hr>
<p>The current status of the problem is a <strong>five-sigma mismatch</strong> between theoretical calculations and experimental measurements. This discrepancy has persisted for the past two to three years.</p>
<p>Earlier, there were issues with QED calculations, but those were resolved. Now, the gap suggests potential <strong>new physics</strong>.</p>
<p>Theoretical predictions reach a precision of <strong>60 parts per billion</strong>, while experimental measurements also achieve <strong>60 parts per billion</strong>. Yet, when comparing independent theoretical methods, a five-sigma discrepancy remains:</p>
<p><span class="math display">
\Delta a_\mu = a_\mu^{\text{exp}} - a_\mu^{\text{theory}} \approx (251 \pm 59) \times 10^{-11}
</span></p>
</section>
<section id="challenges-in-hadronic-contributions-and-the-weakening-new-physics-signal" class="level3" data-number="12.6">
<h3 data-number="12.6" class="anchored" data-anchor-id="challenges-in-hadronic-contributions-and-the-weakening-new-physics-signal"><span class="header-section-number">12.6</span> Challenges in Hadronic Contributions and the Weakening New Physics Signal</h3>
<p>In later years, two works threatened this new physics discovery. The first is the <strong>lattice calculation</strong> on hadronic vacuum polarization. The lattice actually computes this quantity, but only part of it, because they work in different domains. They don’t work in the space domain with <span class="math inline">Q^2</span>, but in the <strong>time domain</strong>. They interrelate the two and calculate the part of this quantity that’s also possible to evaluate theoretically. And they disagree.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key Formula</strong>: The Hadronic Vacuum Polarization (HVP) contribution to muon <span class="math inline">g-2</span> is given by: <span class="math display">
a_\mu^{\text{HVP}} = \left(\frac{\alpha}{\pi}\right)^2 \int_{m_\pi^2}^\infty \frac{ds}{s} K(s) R(s)
</span> where <span class="math inline">K(s)</span> is a kernel function and <span class="math inline">R(s)</span> is the hadronic <span class="math inline">R</span>-ratio from <span class="math inline">e^+e^- \to \text{hadrons}</span>.</p>
</div>
</div>
</div>
<p>Lattice disagrees with <strong>phenomenological calculations</strong> using perturbative methods, which calls part of this technique into question. This isn’t purely theoretical—there’s experimental input, specifically the <span class="math inline">R</span>-ratio, which has uncertainties. These uncertainties are still large, and they dominate the error. Currently, the blame falls on the region between the <span class="math inline">\rho</span> and <span class="math inline">\phi</span> resonances, where experimental data is poor. This mismatch between lattice and experiment likely comes from there.</p>
<p>If you take the new lattice data, the discrepancy shrinks from <span class="math inline">5\sigma</span> to <span class="math inline">1.8\sigma</span>. Later last year, the <strong>CMD experiment</strong> in Novosibirsk published new measurements of this region, specifically around the <span class="math inline">\rho</span> resonance. They claim these measurements are inconsistent with past experiments but consistent with the experimental value of <span class="math inline">g-2</span> if their values are used.</p>
<p>This indication for new physics is weakening slowly, but it remains a puzzle. There’s an experimental effort to build new facilities for more precise measurements. Theoretically, there’s a major effort to properly calculate <strong>hadronic effects</strong>. Hadronic physics remains the main obstacle in determining whether there’s a true mismatch.</p>
<hr>
<p>I think we’re done. Questions? We have time. One thing I’d like to clarify: When fitting these oscillations, do you extract <span class="math inline">W_C</span> or the difference between them? I’ve seen papers with expressions for vacuum polarization that seem to have typos, so I’ll check with colleagues. But roughly, now you have a basic idea—when you hear <strong>HLBL</strong> or <strong>HVP</strong>, you’ll know what they mean.</p>
<p><strong>Question:</strong> Why can’t we be sure the main contributions are hadronic? Even if we evaluate them correctly, other contributions might just be smaller. <strong>Answer:</strong> That’s a good point. I misspoke earlier—it’s not that they’re the largest contributions, but they have the leading <em>uncertainty</em>. They’re small, but we don’t know them precisely enough to reduce the uncertainty further. The hadronic parts are the most difficult to calculate.</p>
<p>The uncertainty was <strong>600 ppb</strong> (parts per billion), but new work has reduced it to 200 or even 100 ppb. Still, it remains the dominant source of uncertainty—we know other contributions much better.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Light-by-light (HLBL)</strong> scattering involves 64 terms and is even more challenging due to virtual photons: <span class="math display">
a_\mu^{\text{HLBL}} \propto \int d^4q_1 \, d^4q_2 \, \mathcal{K}(q_1, q_2) \Pi^{\mu\nu\rho\sigma}(q_1, q_2)
</span> where <span class="math inline">\Pi^{\mu\nu\rho\sigma}</span> is the hadronic light-by-light scattering amplitude.</p>
</div>
</div>
</div>
<p><strong>Logistics:</strong></p>
<ul>
<li><strong>Thursday</strong>: Obstacle course (canceled if weather doesn’t improve).</li>
<li><strong>Friday at 2:00</strong>: Project meeting (everyone invited, Swiss sweets provided).</li>
</ul>
<p>See you at Linde Park.</p>
</section>
<section id="seeking-sources-on-sun-representation-theory-via-young-tableaux" class="level3" data-number="12.7">
<h3 data-number="12.7" class="anchored" data-anchor-id="seeking-sources-on-sun-representation-theory-via-young-tableaux"><span class="header-section-number">12.7</span> Seeking Sources on SU(N) Representation Theory via Young Tableaux</h3>
<p>I was wondering—maybe a question for a problem of mine. Maybe you can answer it.</p>
<p>I’m currently looking for a book explaining the <strong>representation theory of SU(N)</strong>. I read in a textbook how you get representations from <strong>Young tableaux</strong> using representations of <span class="math inline">S_n</span>. Very exciting.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The connection between SU(N) representations and symmetric groups <span class="math inline">S_n</span> via Young tableaux involves several key formulas:</p>
<ul>
<li>Dimension of SU(N) reps: <span class="math inline">\text{dim}(λ) = \prod_{1 ≤ i &lt; j ≤ N} \frac{λ_i - λ_j + j - i}{j - i}</span></li>
<li>Hook length formula for <span class="math inline">S_n</span>: <span class="math inline">\text{dim}(λ) = \frac{n!}{\prod_{(i,j) ∈ λ} h_{i,j}}</span></li>
<li>Branching rules and tensor products follow Littlewood-Richardson coefficients.</li>
</ul>
</div>
</div>
</div>
<p>And it’s impossible to find a source for that. Z? That’s a book? What do you mean, Z? That’s why I went to [Yugo?].</p>
<p>This is rather <strong>good level</strong>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>